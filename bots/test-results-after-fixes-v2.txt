=== RUN   TestConfigValidate
=== RUN   TestConfigValidate/valid_config
=== RUN   TestConfigValidate/negative_complete_block_timeout
=== RUN   TestConfigValidate/zero_query_block_concurrency
=== RUN   TestConfigValidate/negative_complete_block_concurrency
=== RUN   TestConfigValidate/negative_instance_flush_period
=== RUN   TestConfigValidate/zero_instance_flush_period
=== RUN   TestConfigValidate/negative_instance_cleanup_period
=== RUN   TestConfigValidate/zero_instance_cleanup_period
=== RUN   TestConfigValidate/negative_max_trace_live
=== RUN   TestConfigValidate/zero_max_trace_live
=== RUN   TestConfigValidate/negative_max_trace_idle
=== RUN   TestConfigValidate/zero_max_trace_idle
=== RUN   TestConfigValidate/negative_max_block_duration
=== RUN   TestConfigValidate/zero_max_block_duration
=== RUN   TestConfigValidate/zero_max_block_bytes
=== RUN   TestConfigValidate/max_trace_idle_greater_than_max_trace_live
--- PASS: TestConfigValidate (0.00s)
    --- PASS: TestConfigValidate/valid_config (0.00s)
    --- PASS: TestConfigValidate/negative_complete_block_timeout (0.00s)
    --- PASS: TestConfigValidate/zero_query_block_concurrency (0.00s)
    --- PASS: TestConfigValidate/negative_complete_block_concurrency (0.00s)
    --- PASS: TestConfigValidate/negative_instance_flush_period (0.00s)
    --- PASS: TestConfigValidate/zero_instance_flush_period (0.00s)
    --- PASS: TestConfigValidate/negative_instance_cleanup_period (0.00s)
    --- PASS: TestConfigValidate/zero_instance_cleanup_period (0.00s)
    --- PASS: TestConfigValidate/negative_max_trace_live (0.00s)
    --- PASS: TestConfigValidate/zero_max_trace_live (0.00s)
    --- PASS: TestConfigValidate/negative_max_trace_idle (0.00s)
    --- PASS: TestConfigValidate/zero_max_trace_idle (0.00s)
    --- PASS: TestConfigValidate/negative_max_block_duration (0.00s)
    --- PASS: TestConfigValidate/zero_max_block_duration (0.00s)
    --- PASS: TestConfigValidate/zero_max_block_bytes (0.00s)
    --- PASS: TestConfigValidate/max_trace_idle_greater_than_max_trace_live (0.00s)
=== RUN   TestDeleteOldBlocks_ContinuesOnFailure
    logger.go:54: 2026-02-11 14:36:55.959002447 -0500 EST m=+0.050829984 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:55.959185048 -0500 EST m=+0.051012580 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:55.959277053 -0500 EST m=+0.051104585 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:55.959568272 -0500 EST m=+0.051395803 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:55.961360863 -0500 EST m=+0.053188396 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:55.961396395 -0500 EST m=+0.053223927 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:55.961420119 -0500 EST m=+0.053247652 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:55.962441097 -0500 EST m=+0.054268643 level debug partition 0 msg initial lag calculated lag 0 committed 1770831415961 end 0
    logger.go:54: 2026-02-11 14:36:55.962564596 -0500 EST m=+0.054392135 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:55.962937478 -0500 EST m=+0.054765023 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831415961 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.004944138 -0500 EST m=+0.096771675 level info tenant fake msg queueing wal block for completion block fbd841f1-5081-4fe5-8511-7c4da370ce3b size 134988
    logger.go:54: 2026-02-11 14:36:56.006689866 -0500 EST m=+0.098517397 level warn tenant fake msg deleting old WAL block (may have had completion issues) block fbd841f1-5081-4fe5-8511-7c4da370ce3b tenant fake
    instance_cleanup_test.go:58: Initial WAL blocks: 1, Final WAL blocks: 0
    logger.go:54: 2026-02-11 14:36:56.006867312 -0500 EST m=+0.098694851 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.006861334 -0500 EST m=+0.098688880 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.006971186 -0500 EST m=+0.098798725 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:56.006878471 -0500 EST m=+0.098706003 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.006866886 -0500 EST m=+0.098694418 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.00707951 -0500 EST m=+0.098907042 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.00720915 -0500 EST m=+0.099036682 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.007245851 -0500 EST m=+0.099073413 level info partition 0 msg stopping partition reader
--- PASS: TestDeleteOldBlocks_ContinuesOnFailure (0.05s)
=== RUN   TestDeleteOldBlocks_OnlyOldBlocksDeleted
    logger.go:54: 2026-02-11 14:36:56.008417217 -0500 EST m=+0.100244749 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.008469197 -0500 EST m=+0.100296729 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.008525086 -0500 EST m=+0.100352618 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.008711529 -0500 EST m=+0.100539068 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.010074987 -0500 EST m=+0.101902533 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.010123662 -0500 EST m=+0.101951201 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.010160101 -0500 EST m=+0.101987639 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.01101346 -0500 EST m=+0.102841005 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416010 end 0
    logger.go:54: 2026-02-11 14:36:56.011099679 -0500 EST m=+0.102927225 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.011444725 -0500 EST m=+0.103272257 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416010 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.025059822 -0500 EST m=+0.116887369 level info tenant fake msg queueing wal block for completion block acff2b1c-05e9-4c1e-88dc-cd8e3ab23047 size 46378
    logger.go:54: 2026-02-11 14:36:56.027355735 -0500 EST m=+0.119183267 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.027364018 -0500 EST m=+0.119191565 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.027423701 -0500 EST m=+0.119251247 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.02736217 -0500 EST m=+0.119189709 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.027473649 -0500 EST m=+0.119301195 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:56.027574228 -0500 EST m=+0.119401760 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.027642143 -0500 EST m=+0.119469676 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.02758051 -0500 EST m=+0.119408064 level info partition 0 msg stopping partition reader
--- PASS: TestDeleteOldBlocks_OnlyOldBlocksDeleted (0.02s)
=== RUN   TestCompleteBlock_ConcurrentAttempts
--- PASS: TestCompleteBlock_ConcurrentAttempts (0.00s)
=== RUN   TestCompleteBlock_CompletingBlocksCleanup
--- PASS: TestCompleteBlock_CompletingBlocksCleanup (0.01s)
=== RUN   TestCompleteBlock_NoLockHeldDuringIO
--- PASS: TestCompleteBlock_NoLockHeldDuringIO (0.00s)
=== RUN   TestCompleteBlock_NoOrphanAccumulation
    logger.go:54: 2026-02-11 14:36:56.039344838 -0500 EST m=+0.131172370 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.039419283 -0500 EST m=+0.131246815 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.03949118 -0500 EST m=+0.131318719 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.039861521 -0500 EST m=+0.131689055 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.041807904 -0500 EST m=+0.133635443 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.041858758 -0500 EST m=+0.133686297 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.041895598 -0500 EST m=+0.133723137 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.042967714 -0500 EST m=+0.134795253 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416042 end 0
    logger.go:54: 2026-02-11 14:36:56.043053817 -0500 EST m=+0.134881364 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.043736112 -0500 EST m=+0.135563651 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416042 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.055433961 -0500 EST m=+0.147261511 level info tenant fake msg queueing wal block for completion block 085b0695-3ea2-4dd1-895c-f3c3e2b80023 size 38358
    logger.go:54: 2026-02-11 14:36:56.079265866 -0500 EST m=+0.171093405 level info tenant fake msg completed block id 085b0695-3ea2-4dd1-895c-f3c3e2b80023
    logger.go:54: 2026-02-11 14:36:56.099951646 -0500 EST m=+0.191779177 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.099954336 -0500 EST m=+0.191781869 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.100024666 -0500 EST m=+0.191852212 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:56.099955891 -0500 EST m=+0.191783423 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.0999792 -0500 EST m=+0.191806738 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.100097735 -0500 EST m=+0.191925267 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.100344716 -0500 EST m=+0.192172263 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:56.100355761 -0500 EST m=+0.192183294 level info msg instance removed from the ring ring live-store
--- PASS: TestCompleteBlock_NoOrphanAccumulation (0.06s)
=== RUN   TestReloadBlocks_OrphanCleanup
    logger.go:54: 2026-02-11 14:36:56.101561133 -0500 EST m=+0.193388666 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.101617073 -0500 EST m=+0.193444605 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.101680425 -0500 EST m=+0.193507958 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.101819598 -0500 EST m=+0.193647130 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.102948847 -0500 EST m=+0.194776393 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.103003457 -0500 EST m=+0.194830996 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.103040054 -0500 EST m=+0.194867593 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.103888459 -0500 EST m=+0.195715996 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416103 end 0
    logger.go:54: 2026-02-11 14:36:56.103946335 -0500 EST m=+0.195773874 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.104134366 -0500 EST m=+0.195961899 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416103 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.117872716 -0500 EST m=+0.209700262 level info tenant fake msg queueing wal block for completion block b078acb3-3bdf-4a9a-a4d6-c7f3a034a395 size 43068
    logger.go:54: 2026-02-11 14:36:56.144708387 -0500 EST m=+0.236535938 level info tenant fake msg completed block id b078acb3-3bdf-4a9a-a4d6-c7f3a034a395
    logger.go:54: 2026-02-11 14:36:56.145131864 -0500 EST m=+0.236959397 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.145156466 -0500 EST m=+0.236984012 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.145198988 -0500 EST m=+0.237026526 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.145178416 -0500 EST m=+0.237005955 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.145185545 -0500 EST m=+0.237013079 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:56.14532343 -0500 EST m=+0.237150961 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:56.145443446 -0500 EST m=+0.237270980 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.145527706 -0500 EST m=+0.237355242 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.146283753 -0500 EST m=+0.238111285 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.146352933 -0500 EST m=+0.238180466 level info msg beginning replay file 78e51600-4504-44f1-a775-ef6789243b5b+fake+vParquet4 size 60
    logger.go:54: 2026-02-11 14:36:56.146413719 -0500 EST m=+0.238241252 level warn msg failed to replay block. removing. file 78e51600-4504-44f1-a775-ef6789243b5b+fake+vParquet4 err error reading wal meta json: /tmp/TestReloadBlocks_OrphanCleanup2231948115/001/78e51600-4504-44f1-a775-ef6789243b5b+fake+vParquet4/meta.json: open /tmp/TestReloadBlocks_OrphanCleanup2231948115/001/78e51600-4504-44f1-a775-ef6789243b5b+fake+vParquet4/meta.json: no such file or directory
    logger.go:54: 2026-02-11 14:36:56.146489708 -0500 EST m=+0.238317242 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.146589985 -0500 EST m=+0.238417517 level info msg reloading complete blocks tenant fake count 1
    logger.go:54: 2026-02-11 14:36:56.146616017 -0500 EST m=+0.238443549 level info msg reloading complete block block b078acb3-3bdf-4a9a-a4d6-c7f3a034a395
    logger.go:54: 2026-02-11 14:36:56.146761832 -0500 EST m=+0.238589365 level info msg reloaded complete block block b078acb3-3bdf-4a9a-a4d6-c7f3a034a395
    logger.go:54: 2026-02-11 14:36:56.148862311 -0500 EST m=+0.240689843 level info msg scanning for orphaned complete blocks tenant fake
    logger.go:54: 2026-02-11 14:36:56.148969266 -0500 EST m=+0.240796803 level debug msg identified potential orphan candidates count 0 tenant fake
    logger.go:54: 2026-02-11 14:36:56.149028966 -0500 EST m=+0.240856497 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.149236007 -0500 EST m=+0.241063541 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.150637261 -0500 EST m=+0.242464794 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.150683529 -0500 EST m=+0.242511061 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.15072617 -0500 EST m=+0.242553704 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.151859667 -0500 EST m=+0.243687199 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416151 end 0
    logger.go:54: 2026-02-11 14:36:56.151939415 -0500 EST m=+0.243766947 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.152213857 -0500 EST m=+0.244041396 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416151 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.170479571 -0500 EST m=+0.262307118 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.170499033 -0500 EST m=+0.262326578 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.170689294 -0500 EST m=+0.262516841 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:56.170504793 -0500 EST m=+0.262332324 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.170510413 -0500 EST m=+0.262337946 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.170576636 -0500 EST m=+0.262404175 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:56.170907164 -0500 EST m=+0.262734703 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.170987071 -0500 EST m=+0.262814618 level info msg instance removed from the ring ring live-store
--- PASS: TestReloadBlocks_OrphanCleanup (0.07s)
=== RUN   TestInstanceSearch
    logger.go:54: 2026-02-11 14:36:56.171849173 -0500 EST m=+0.263676706 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.171913432 -0500 EST m=+0.263740963 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.17197349 -0500 EST m=+0.263801022 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.172131541 -0500 EST m=+0.263959080 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.173354004 -0500 EST m=+0.265181543 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.173399154 -0500 EST m=+0.265226693 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.173433594 -0500 EST m=+0.265261133 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.174003325 -0500 EST m=+0.265830858 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416173 end 0
    logger.go:54: 2026-02-11 14:36:56.174047187 -0500 EST m=+0.265874719 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.174209751 -0500 EST m=+0.266037284 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416173 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.229947 -0500 EST m=+0.321774546 level info tenant fake msg queueing wal block for completion block 17db8002-a12b-4b73-a01c-fbc1bf04990b size 178296
    logger.go:54: 2026-02-11 14:36:56.292704308 -0500 EST m=+0.384531855 level info tenant fake msg completed block id 17db8002-a12b-4b73-a01c-fbc1bf04990b
    logger.go:54: 2026-02-11 14:36:56.301625649 -0500 EST m=+0.393453196 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.301649494 -0500 EST m=+0.393477025 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.301732336 -0500 EST m=+0.393559883 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:56.301646348 -0500 EST m=+0.393473888 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.301669053 -0500 EST m=+0.393496600 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.301871183 -0500 EST m=+0.393698722 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.301922537 -0500 EST m=+0.393750092 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:56.301961478 -0500 EST m=+0.393789018 level info msg instance removed from the ring ring live-store
--- PASS: TestInstanceSearch (0.13s)
=== RUN   TestInstanceSearchTraceQL
=== RUN   TestInstanceSearchTraceQL/Query:{_.service.name_=_"test-service"_}
    logger.go:54: 2026-02-11 14:36:56.303520746 -0500 EST m=+0.395348310 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.303614022 -0500 EST m=+0.395441561 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.303722896 -0500 EST m=+0.395550435 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.303954793 -0500 EST m=+0.395782326 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.305296014 -0500 EST m=+0.397123554 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.305346951 -0500 EST m=+0.397174490 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.305380657 -0500 EST m=+0.397208196 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.306464347 -0500 EST m=+0.398291893 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416306 end 0
    logger.go:54: 2026-02-11 14:36:56.306576323 -0500 EST m=+0.398403862 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.306836358 -0500 EST m=+0.398663897 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416306 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.403102465 -0500 EST m=+0.494930012 level info tenant fake msg queueing wal block for completion block a3113c43-a13f-4634-b61a-12a48f751bc8 size 307215
    logger.go:54: 2026-02-11 14:36:56.499779105 -0500 EST m=+0.591606654 level info tenant fake msg completed block id a3113c43-a13f-4634-b61a-12a48f751bc8
    logger.go:54: 2026-02-11 14:36:56.513848706 -0500 EST m=+0.605676242 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.513850188 -0500 EST m=+0.605677734 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.513914284 -0500 EST m=+0.605741820 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.513859382 -0500 EST m=+0.605686921 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.514017597 -0500 EST m=+0.605845133 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:56.514042922 -0500 EST m=+0.605870458 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.514097858 -0500 EST m=+0.605925394 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.513913256 -0500 EST m=+0.605740795 level error msg metric lag failed: err context canceled retries 1
=== RUN   TestInstanceSearchTraceQL/Query:{_duration_>=_1s_}
    logger.go:54: 2026-02-11 14:36:56.51555914 -0500 EST m=+0.607386673 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.515625204 -0500 EST m=+0.607452737 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.515699416 -0500 EST m=+0.607526948 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.515903826 -0500 EST m=+0.607731365 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.517388688 -0500 EST m=+0.609216219 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.517426423 -0500 EST m=+0.609253955 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.517447484 -0500 EST m=+0.609275016 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.518055072 -0500 EST m=+0.609882604 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416517 end 0
    logger.go:54: 2026-02-11 14:36:56.518119828 -0500 EST m=+0.609947359 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.518290333 -0500 EST m=+0.610117866 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416517 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.614734463 -0500 EST m=+0.706562001 level info tenant fake msg queueing wal block for completion block 532e60a1-7f3b-43c4-89db-96c417e27a81 size 314833
    logger.go:54: 2026-02-11 14:36:56.70309416 -0500 EST m=+0.794921707 level info tenant fake msg completed block id 532e60a1-7f3b-43c4-89db-96c417e27a81
    logger.go:54: 2026-02-11 14:36:56.712955769 -0500 EST m=+0.804783301 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.712957684 -0500 EST m=+0.804785217 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.713022796 -0500 EST m=+0.804850342 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.712968229 -0500 EST m=+0.804795764 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.713024291 -0500 EST m=+0.804851837 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:56.71321399 -0500 EST m=+0.805041521 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:56.713352854 -0500 EST m=+0.805180401 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.71342034 -0500 EST m=+0.805247877 level info msg instance removed from the ring ring live-store
=== RUN   TestInstanceSearchTraceQL/Query:{_duration_>=_1s_&&_.service.name_=_"test-service"_}
    logger.go:54: 2026-02-11 14:36:56.714331907 -0500 EST m=+0.806159440 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.714401279 -0500 EST m=+0.806228811 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.714479347 -0500 EST m=+0.806306880 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.71465946 -0500 EST m=+0.806486991 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.715715096 -0500 EST m=+0.807542628 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.715745976 -0500 EST m=+0.807573507 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.715766031 -0500 EST m=+0.807593564 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.716357081 -0500 EST m=+0.808184613 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416716 end 0
    logger.go:54: 2026-02-11 14:36:56.716414629 -0500 EST m=+0.808242161 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.716572314 -0500 EST m=+0.808399846 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416716 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:56.820733335 -0500 EST m=+0.912560871 level info tenant fake msg queueing wal block for completion block d7ec4f5a-3510-439d-9e01-40b5c0933697 size 337218
    logger.go:54: 2026-02-11 14:36:56.920468278 -0500 EST m=+1.012295815 level info tenant fake msg completed block id d7ec4f5a-3510-439d-9e01-40b5c0933697
    logger.go:54: 2026-02-11 14:36:56.934559827 -0500 EST m=+1.026387358 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:56.934594216 -0500 EST m=+1.026421761 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:56.934683954 -0500 EST m=+1.026511486 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.934737793 -0500 EST m=+1.026565326 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:56.934745882 -0500 EST m=+1.026573414 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:56.934558774 -0500 EST m=+1.026386306 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:56.934574947 -0500 EST m=+1.026402492 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:56.934648874 -0500 EST m=+1.026476407 level error msg metric lag failed: err context canceled retries 1
--- PASS: TestInstanceSearchTraceQL (0.63s)
    --- PASS: TestInstanceSearchTraceQL/Query:{_.service.name_=_"test-service"_} (0.21s)
    --- PASS: TestInstanceSearchTraceQL/Query:{_duration_>=_1s_} (0.20s)
    --- PASS: TestInstanceSearchTraceQL/Query:{_duration_>=_1s_&&_.service.name_=_"test-service"_} (0.22s)
=== RUN   TestInstanceSearchWithStartAndEnd
    logger.go:54: 2026-02-11 14:36:56.936139551 -0500 EST m=+1.027967083 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:56.936200392 -0500 EST m=+1.028027925 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:56.936287438 -0500 EST m=+1.028114970 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:56.936444957 -0500 EST m=+1.028272489 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:56.937537268 -0500 EST m=+1.029364815 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:56.937585139 -0500 EST m=+1.029412685 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:56.937622467 -0500 EST m=+1.029450006 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:56.938469828 -0500 EST m=+1.030297360 level debug partition 0 msg initial lag calculated lag 0 committed 1770831416938 end 0
    logger.go:54: 2026-02-11 14:36:56.938531265 -0500 EST m=+1.030358797 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:56.938703829 -0500 EST m=+1.030531360 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831416938 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:57.001026302 -0500 EST m=+1.092853834 level info tenant fake msg queueing wal block for completion block f73b3f86-9630-4147-b094-c2867c1a7acd size 174363
    logger.go:54: 2026-02-11 14:36:57.063476533 -0500 EST m=+1.155304080 level info tenant fake msg completed block id f73b3f86-9630-4147-b094-c2867c1a7acd
    logger.go:54: 2026-02-11 14:36:57.084424589 -0500 EST m=+1.176252122 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:57.084433153 -0500 EST m=+1.176260685 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:57.084451715 -0500 EST m=+1.176279261 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:57.084399845 -0500 EST m=+1.176227377 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:57.084643501 -0500 EST m=+1.176471034 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.084711794 -0500 EST m=+1.176539326 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:57.084731029 -0500 EST m=+1.176558562 level info msg instance removed from the ring ring live-store
--- PASS: TestInstanceSearchWithStartAndEnd (0.15s)
=== RUN   TestInstanceSearchTags
    logger.go:54: 2026-02-11 14:36:57.086756626 -0500 EST m=+1.178584172 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:57.086857035 -0500 EST m=+1.178684580 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:57.086966354 -0500 EST m=+1.178793893 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:57.087190132 -0500 EST m=+1.179017671 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:57.088620188 -0500 EST m=+1.180447735 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:57.088667548 -0500 EST m=+1.180495087 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:57.088705751 -0500 EST m=+1.180533290 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:57.089690657 -0500 EST m=+1.181518204 level debug partition 0 msg initial lag calculated lag 0 committed 1770831417089 end 0
    logger.go:54: 2026-02-11 14:36:57.089767269 -0500 EST m=+1.181594814 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:57.090060404 -0500 EST m=+1.181887944 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831417089 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:57.169752586 -0500 EST m=+1.261580135 level info tenant fake msg queueing wal block for completion block 6d1ea550-8820-44a5-b012-2ebae576544f size 174419
    logger.go:54: 2026-02-11 14:36:57.261350805 -0500 EST m=+1.353178352 level info tenant fake msg completed block id 6d1ea550-8820-44a5-b012-2ebae576544f
    logger.go:54: 2026-02-11 14:36:57.305987122 -0500 EST m=+1.397814655 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:57.305992326 -0500 EST m=+1.397819858 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:57.305987838 -0500 EST m=+1.397815377 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:57.306010595 -0500 EST m=+1.397838140 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:57.306054774 -0500 EST m=+1.397882313 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:57.306135834 -0500 EST m=+1.397963367 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.306205892 -0500 EST m=+1.398033426 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:57.306233175 -0500 EST m=+1.398060708 level info msg instance removed from the ring ring live-store
--- PASS: TestInstanceSearchTags (0.22s)
=== RUN   TestInstanceSearchNoData
    logger.go:54: 2026-02-11 14:36:57.307800783 -0500 EST m=+1.399628322 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:57.307896331 -0500 EST m=+1.399723877 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:57.307992214 -0500 EST m=+1.399819753 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:57.308230646 -0500 EST m=+1.400058178 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:57.309426691 -0500 EST m=+1.401254222 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:57.309458661 -0500 EST m=+1.401286192 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:57.309479011 -0500 EST m=+1.401306543 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:57.310440111 -0500 EST m=+1.402267657 level debug partition 0 msg initial lag calculated lag 0 committed 1770831417310 end 0
    logger.go:54: 2026-02-11 14:36:57.310523774 -0500 EST m=+1.402351319 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:57.310821657 -0500 EST m=+1.402649196 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831417310 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:57.311187539 -0500 EST m=+1.403015070 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:57.311256626 -0500 EST m=+1.403084158 level error msg metric lag failed: err fetch offsets: context canceled retries 1
    logger.go:54: 2026-02-11 14:36:57.311278404 -0500 EST m=+1.403105943 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:57.311279119 -0500 EST m=+1.403106664 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:57.311286034 -0500 EST m=+1.403113579 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:57.311406596 -0500 EST m=+1.403234151 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:57.311534398 -0500 EST m=+1.403361937 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.311613976 -0500 EST m=+1.403441515 level info msg instance removed from the ring ring live-store
--- PASS: TestInstanceSearchNoData (0.01s)
=== RUN   TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial
    logger.go:54: 2026-02-11 14:36:57.312702786 -0500 EST m=+1.404530318 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:57.31276463 -0500 EST m=+1.404592162 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:57.312819711 -0500 EST m=+1.404647243 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:57.312972878 -0500 EST m=+1.404800416 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:57.314133673 -0500 EST m=+1.405961205 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:57.31416361 -0500 EST m=+1.405991141 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:57.314184339 -0500 EST m=+1.406011872 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:57.314903276 -0500 EST m=+1.406730808 level debug partition 0 msg initial lag calculated lag 0 committed 1770831417314 end 0
    logger.go:54: 2026-02-11 14:36:57.314948188 -0500 EST m=+1.406775726 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:57.315206493 -0500 EST m=+1.407034032 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831417314 e-1 ce0}]
=== RUN   TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial/SearchTagValues
=== NAME  TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial
    logger.go:54: 2026-02-11 14:36:57.362806325 -0500 EST m=+1.454633874 level warn tenant fake msg Search of tags exceeded limit,  reduce cardinality or size of tags tag foo orgID fake stopReason Max data exceeded: dataSize 8, maxDataSize 12
=== RUN   TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial/SearchTagValuesV2
=== NAME  TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial
    logger.go:54: 2026-02-11 14:36:57.367901192 -0500 EST m=+1.459728728 level warn tenant fake msg size of tag values exceeded limit, reduce cardinality or size of tags tag .foo tenant fake limit 12 size 10
    logger.go:54: 2026-02-11 14:36:57.368020004 -0500 EST m=+1.459847540 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:57.368061526 -0500 EST m=+1.459889128 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:57.368102048 -0500 EST m=+1.459929580 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:57.368033111 -0500 EST m=+1.459860649 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:57.368035336 -0500 EST m=+1.459862875 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:57.368137191 -0500 EST m=+1.459964724 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:57.368197467 -0500 EST m=+1.460025003 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.368339816 -0500 EST m=+1.460167349 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.368696271 -0500 EST m=+1.460523810 level info tenant fake msg queueing wal block for completion block f2d7d3d2-0261-4972-8702-185e7597ce31 size 176394
    logger.go:54: 2026-02-11 14:36:57.370924497 -0500 EST m=+1.462752032 level debug msg enqueueing complete op tenant fake block f2d7d3d2-0261-4972-8702-185e7597ce31 attempts 0
--- PASS: TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial (0.06s)
    --- PASS: TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial/SearchTagValues (0.01s)
    --- PASS: TestInstanceSearchMaxBytesPerTagValuesQueryReturnsPartial/SearchTagValuesV2 (0.01s)
=== RUN   TestInstanceSearchMaxBlocksPerTagValuesQueryReturnsPartial
    logger.go:54: 2026-02-11 14:36:57.372561442 -0500 EST m=+1.464388974 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:57.37261582 -0500 EST m=+1.464443352 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:57.372672273 -0500 EST m=+1.464499805 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:57.372847624 -0500 EST m=+1.464675163 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:57.374150626 -0500 EST m=+1.465978174 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:57.374198819 -0500 EST m=+1.466026358 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:57.374236262 -0500 EST m=+1.466063801 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:57.375297428 -0500 EST m=+1.467124975 level debug partition 0 msg initial lag calculated lag 0 committed 1770831417374 end 0
    logger.go:54: 2026-02-11 14:36:57.375386134 -0500 EST m=+1.467213672 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:57.375664687 -0500 EST m=+1.467492218 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831417374 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:57.419875151 -0500 EST m=+1.511702687 level info tenant fake msg queueing wal block for completion block 11fac70e-8082-4204-815a-780421cd0604 size 175919
    logger.go:54: 2026-02-11 14:36:57.502089361 -0500 EST m=+1.593916908 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:57.502118648 -0500 EST m=+1.593946187 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:57.502132833 -0500 EST m=+1.593960372 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:57.502238094 -0500 EST m=+1.594065626 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.502140975 -0500 EST m=+1.593968521 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:57.502240663 -0500 EST m=+1.594068210 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:57.502300525 -0500 EST m=+1.594128057 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.502444887 -0500 EST m=+1.594272426 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:57.503055339 -0500 EST m=+1.594882878 level info tenant fake msg queueing wal block for completion block c3a0b1be-4adc-43fa-8031-380a948d1239 size 162039
    logger.go:54: 2026-02-11 14:36:57.504771373 -0500 EST m=+1.596598905 level debug msg enqueueing complete op tenant fake block c3a0b1be-4adc-43fa-8031-380a948d1239 attempts 0
--- PASS: TestInstanceSearchMaxBlocksPerTagValuesQueryReturnsPartial (0.13s)
=== RUN   TestSearchTagsV2Limits
=== RUN   TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=0
    logger.go:54: 2026-02-11 14:36:57.505596156 -0500 EST m=+1.597423693 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:57.505660683 -0500 EST m=+1.597488218 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:57.505722799 -0500 EST m=+1.597550334 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:57.505893437 -0500 EST m=+1.597720979 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:57.507315617 -0500 EST m=+1.599143162 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:57.507363208 -0500 EST m=+1.599190747 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:57.507397146 -0500 EST m=+1.599224685 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:57.50797978 -0500 EST m=+1.599807312 level debug partition 0 msg initial lag calculated lag 0 committed 1770831417507 end 0
    logger.go:54: 2026-02-11 14:36:57.508033642 -0500 EST m=+1.599861174 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:57.50818975 -0500 EST m=+1.600017282 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831417507 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:57.517259988 -0500 EST m=+1.609087535 level info tenant fake msg queueing wal block for completion block 136947f4-d38e-4e8d-8e40-d211fd3284ae size 31608
    logger.go:54: 2026-02-11 14:36:57.537403072 -0500 EST m=+1.629230618 level info tenant fake msg completed block id 136947f4-d38e-4e8d-8e40-d211fd3284ae
    logger.go:54: 2026-02-11 14:36:57.545788555 -0500 EST m=+1.637616102 level info tenant fake msg queueing wal block for completion block 38de710b-dd75-4dd4-8ff1-ee32badb45ba size 33678
    logger.go:54: 2026-02-11 14:36:57.5676983 -0500 EST m=+1.659525847 level info tenant fake msg completed block id 38de710b-dd75-4dd4-8ff1-ee32badb45ba
    logger.go:54: 2026-02-11 14:36:57.576430884 -0500 EST m=+1.668258431 level info tenant fake msg queueing wal block for completion block f575ee13-3dcb-431f-81b8-d2f15b3d5290 size 34213
    logger.go:54: 2026-02-11 14:36:57.596299054 -0500 EST m=+1.688126600 level info tenant fake msg completed block id f575ee13-3dcb-431f-81b8-d2f15b3d5290
    logger.go:54: 2026-02-11 14:36:57.60509424 -0500 EST m=+1.696921789 level info tenant fake msg queueing wal block for completion block bf694206-caae-440a-a526-83a5485a3be6 size 35805
    logger.go:54: 2026-02-11 14:36:57.628605334 -0500 EST m=+1.720432881 level info tenant fake msg completed block id bf694206-caae-440a-a526-83a5485a3be6
    logger.go:54: 2026-02-11 14:36:57.636503106 -0500 EST m=+1.728330653 level info tenant fake msg queueing wal block for completion block 5404f6ac-93b3-48bb-ab15-fa237fce63bd size 33029
    logger.go:54: 2026-02-11 14:36:57.655954534 -0500 EST m=+1.747782081 level info tenant fake msg completed block id 5404f6ac-93b3-48bb-ab15-fa237fce63bd
    logger.go:54: 2026-02-11 14:36:57.663643892 -0500 EST m=+1.755471439 level info tenant fake msg queueing wal block for completion block 60615582-b20a-4336-8821-e70f61cdf7ad size 32329
    logger.go:54: 2026-02-11 14:36:57.68425794 -0500 EST m=+1.776085487 level info tenant fake msg completed block id 60615582-b20a-4336-8821-e70f61cdf7ad
    logger.go:54: 2026-02-11 14:36:57.691772968 -0500 EST m=+1.783600514 level info tenant fake msg queueing wal block for completion block 7f1c93b2-bc6e-42bb-86d5-5113dffc1a3c size 31521
    logger.go:54: 2026-02-11 14:36:57.711495945 -0500 EST m=+1.803323494 level info tenant fake msg completed block id 7f1c93b2-bc6e-42bb-86d5-5113dffc1a3c
    logger.go:54: 2026-02-11 14:36:57.722533933 -0500 EST m=+1.814361478 level info tenant fake msg queueing wal block for completion block d2b7fa2d-bbc3-4bfd-b746-d61a9051e224 size 30968
    logger.go:54: 2026-02-11 14:36:57.741886523 -0500 EST m=+1.833714069 level info tenant fake msg completed block id d2b7fa2d-bbc3-4bfd-b746-d61a9051e224
    logger.go:54: 2026-02-11 14:36:57.749960386 -0500 EST m=+1.841787932 level info tenant fake msg queueing wal block for completion block fc0a7730-f88f-4b1a-b4ea-0bcc02d23fb8 size 33992
    logger.go:54: 2026-02-11 14:36:57.768861708 -0500 EST m=+1.860689254 level info tenant fake msg completed block id fc0a7730-f88f-4b1a-b4ea-0bcc02d23fb8
    logger.go:54: 2026-02-11 14:36:57.776357756 -0500 EST m=+1.868185304 level info tenant fake msg queueing wal block for completion block f0a132f2-2cb1-479f-93d1-2a8c1e47a437 size 32268
    logger.go:54: 2026-02-11 14:36:57.795363889 -0500 EST m=+1.887191436 level info tenant fake msg completed block id f0a132f2-2cb1-479f-93d1-2a8c1e47a437
    logger.go:54: 2026-02-11 14:36:57.832704375 -0500 EST m=+1.924531907 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:57.832719368 -0500 EST m=+1.924546899 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:57.832721916 -0500 EST m=+1.924549447 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:57.832715977 -0500 EST m=+1.924543510 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:57.832824257 -0500 EST m=+1.924651789 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:57.832927945 -0500 EST m=+1.924755478 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:57.832996035 -0500 EST m=+1.924823567 level info msg instance removed from the ring ring live-store
=== RUN   TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=10
    logger.go:54: 2026-02-11 14:36:57.834111806 -0500 EST m=+1.925939343 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:57.834173445 -0500 EST m=+1.926000978 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:57.834253982 -0500 EST m=+1.926081513 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:57.834414303 -0500 EST m=+1.926241842 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:57.83567622 -0500 EST m=+1.927503752 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:57.835703249 -0500 EST m=+1.927530781 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:57.835723896 -0500 EST m=+1.927551428 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:57.836438345 -0500 EST m=+1.928265878 level debug partition 0 msg initial lag calculated lag 0 committed 1770831417836 end 0
    logger.go:54: 2026-02-11 14:36:57.836496051 -0500 EST m=+1.928323583 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:57.836776891 -0500 EST m=+1.928604430 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831417836 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:57.846207403 -0500 EST m=+1.938034953 level info tenant fake msg queueing wal block for completion block 28ff1dd4-05b2-46bb-9785-85d3a1bf5367 size 35657
    logger.go:54: 2026-02-11 14:36:57.86709292 -0500 EST m=+1.958920466 level info tenant fake msg completed block id 28ff1dd4-05b2-46bb-9785-85d3a1bf5367
    logger.go:54: 2026-02-11 14:36:57.874811551 -0500 EST m=+1.966639098 level info tenant fake msg queueing wal block for completion block 4752e68a-0650-4dd3-8560-cc2cd1d8edc5 size 33174
    logger.go:54: 2026-02-11 14:36:57.895476118 -0500 EST m=+1.987303666 level info tenant fake msg completed block id 4752e68a-0650-4dd3-8560-cc2cd1d8edc5
    logger.go:54: 2026-02-11 14:36:57.905038085 -0500 EST m=+1.996865632 level info tenant fake msg queueing wal block for completion block 4c182eed-4d74-4906-9f36-2845eda80dd8 size 34825
    logger.go:54: 2026-02-11 14:36:57.924941866 -0500 EST m=+2.016769412 level info tenant fake msg completed block id 4c182eed-4d74-4906-9f36-2845eda80dd8
    logger.go:54: 2026-02-11 14:36:57.933488611 -0500 EST m=+2.025316159 level info tenant fake msg queueing wal block for completion block 1ff62082-f64c-495c-b812-21ff240b3633 size 35459
    logger.go:54: 2026-02-11 14:36:57.952966196 -0500 EST m=+2.044793744 level info tenant fake msg completed block id 1ff62082-f64c-495c-b812-21ff240b3633
    logger.go:54: 2026-02-11 14:36:57.961624631 -0500 EST m=+2.053452177 level info tenant fake msg queueing wal block for completion block e4012a87-eb5b-461f-92e0-efc40f43c777 size 35938
    logger.go:54: 2026-02-11 14:36:57.982977139 -0500 EST m=+2.074804676 level info tenant fake msg completed block id e4012a87-eb5b-461f-92e0-efc40f43c777
    logger.go:54: 2026-02-11 14:36:57.990492209 -0500 EST m=+2.082319757 level info tenant fake msg queueing wal block for completion block 0e89a9b2-fcea-46bb-b0d2-7dc9ec79697b size 31842
    logger.go:54: 2026-02-11 14:36:58.008746537 -0500 EST m=+2.100574083 level info tenant fake msg completed block id 0e89a9b2-fcea-46bb-b0d2-7dc9ec79697b
    logger.go:54: 2026-02-11 14:36:58.017058408 -0500 EST m=+2.108885955 level info tenant fake msg queueing wal block for completion block 6e39d5b7-5038-468f-a4ee-78ac089e8ef1 size 34403
    logger.go:54: 2026-02-11 14:36:58.036314811 -0500 EST m=+2.128142357 level info tenant fake msg completed block id 6e39d5b7-5038-468f-a4ee-78ac089e8ef1
    logger.go:54: 2026-02-11 14:36:58.044571616 -0500 EST m=+2.136399156 level info tenant fake msg queueing wal block for completion block ccd75070-78ed-480b-881a-b17c53b4f4eb size 34843
    logger.go:54: 2026-02-11 14:36:58.065535094 -0500 EST m=+2.157362641 level info tenant fake msg completed block id ccd75070-78ed-480b-881a-b17c53b4f4eb
    logger.go:54: 2026-02-11 14:36:58.073511075 -0500 EST m=+2.165338624 level info tenant fake msg queueing wal block for completion block 90af55a2-dcde-4ed5-9e26-cbf5122129cb size 32108
    logger.go:54: 2026-02-11 14:36:58.092845461 -0500 EST m=+2.184673008 level info tenant fake msg completed block id 90af55a2-dcde-4ed5-9e26-cbf5122129cb
    logger.go:54: 2026-02-11 14:36:58.1003682 -0500 EST m=+2.192195750 level info tenant fake msg queueing wal block for completion block 69f3e9f2-99f6-439f-a8b8-35c52feec92e size 31622
    logger.go:54: 2026-02-11 14:36:58.119716826 -0500 EST m=+2.211544373 level info tenant fake msg completed block id 69f3e9f2-99f6-439f-a8b8-35c52feec92e
    logger.go:54: 2026-02-11 14:36:58.123445057 -0500 EST m=+2.215272604 level warn tenant fake msg Search of tags exceeded limit, reduce cardinality or size of tags orgID test stopReason 
    logger.go:54: 2026-02-11 14:36:58.123572344 -0500 EST m=+2.215399875 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:58.123618239 -0500 EST m=+2.215445773 level error msg metric lag failed: err fetch offsets: context canceled retries 1
    logger.go:54: 2026-02-11 14:36:58.1236242 -0500 EST m=+2.215451746 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:58.12358274 -0500 EST m=+2.215410273 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:58.123566005 -0500 EST m=+2.215393537 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:58.123733412 -0500 EST m=+2.215560944 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:58.123827119 -0500 EST m=+2.215654678 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:58.123864164 -0500 EST m=+2.215691698 level info msg instance removed from the ring ring live-store
=== RUN   TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=50
    logger.go:54: 2026-02-11 14:36:58.125092288 -0500 EST m=+2.216919820 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:58.125149523 -0500 EST m=+2.216977055 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:58.125217898 -0500 EST m=+2.217045437 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:58.125451017 -0500 EST m=+2.217278550 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:58.1264994 -0500 EST m=+2.218326932 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:58.12652765 -0500 EST m=+2.218355182 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:58.126546613 -0500 EST m=+2.218374146 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:58.127161399 -0500 EST m=+2.218988931 level debug partition 0 msg initial lag calculated lag 0 committed 1770831418126 end 0
    logger.go:54: 2026-02-11 14:36:58.127207678 -0500 EST m=+2.219035214 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:58.127386634 -0500 EST m=+2.219214165 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831418126 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:58.138090885 -0500 EST m=+2.229918433 level info tenant fake msg queueing wal block for completion block 5cabcc13-2ac2-4e92-8699-9713216e319e size 34739
    logger.go:54: 2026-02-11 14:36:58.158754167 -0500 EST m=+2.250581717 level info tenant fake msg completed block id 5cabcc13-2ac2-4e92-8699-9713216e319e
    logger.go:54: 2026-02-11 14:36:58.166237865 -0500 EST m=+2.258065412 level info tenant fake msg queueing wal block for completion block d5ff32a4-09a0-4a7e-ace2-0dfa26ec591e size 31128
    logger.go:54: 2026-02-11 14:36:58.185632768 -0500 EST m=+2.277460315 level info tenant fake msg completed block id d5ff32a4-09a0-4a7e-ace2-0dfa26ec591e
    logger.go:54: 2026-02-11 14:36:58.193214239 -0500 EST m=+2.285041786 level info tenant fake msg queueing wal block for completion block 023d3cc8-4a37-4b2f-8121-a82a631bcd07 size 32127
    logger.go:54: 2026-02-11 14:36:58.211770161 -0500 EST m=+2.303597708 level info tenant fake msg completed block id 023d3cc8-4a37-4b2f-8121-a82a631bcd07
    logger.go:54: 2026-02-11 14:36:58.222105773 -0500 EST m=+2.313933320 level info tenant fake msg queueing wal block for completion block 2777e784-6a0c-4166-9522-af3e9aa1a76c size 36400
    logger.go:54: 2026-02-11 14:36:58.24356178 -0500 EST m=+2.335389327 level info tenant fake msg completed block id 2777e784-6a0c-4166-9522-af3e9aa1a76c
    logger.go:54: 2026-02-11 14:36:58.251861266 -0500 EST m=+2.343688813 level info tenant fake msg queueing wal block for completion block b7c5fc7b-4dea-4170-8bcc-a6afa3eb317e size 34241
    logger.go:54: 2026-02-11 14:36:58.271801693 -0500 EST m=+2.363629240 level info tenant fake msg completed block id b7c5fc7b-4dea-4170-8bcc-a6afa3eb317e
    logger.go:54: 2026-02-11 14:36:58.280236216 -0500 EST m=+2.372063752 level info tenant fake msg queueing wal block for completion block 81da381f-8ced-4b6e-8ac9-e275cd5f5818 size 33174
    logger.go:54: 2026-02-11 14:36:58.300099922 -0500 EST m=+2.391927455 level info tenant fake msg completed block id 81da381f-8ced-4b6e-8ac9-e275cd5f5818
    logger.go:54: 2026-02-11 14:36:58.307560399 -0500 EST m=+2.399387941 level info tenant fake msg queueing wal block for completion block 73abf6e2-e129-4f31-a785-08d18e7f8b78 size 30282
    logger.go:54: 2026-02-11 14:36:58.326785383 -0500 EST m=+2.418612930 level info tenant fake msg completed block id 73abf6e2-e129-4f31-a785-08d18e7f8b78
    logger.go:54: 2026-02-11 14:36:58.334112375 -0500 EST m=+2.425939921 level info tenant fake msg queueing wal block for completion block 59885ec7-b58d-4317-93e5-902a23daa9aa size 30697
    logger.go:54: 2026-02-11 14:36:58.352658908 -0500 EST m=+2.444486455 level info tenant fake msg completed block id 59885ec7-b58d-4317-93e5-902a23daa9aa
    logger.go:54: 2026-02-11 14:36:58.359872103 -0500 EST m=+2.451699652 level info tenant fake msg queueing wal block for completion block 754de9d0-3382-4bb7-b0ef-5d3783b45c27 size 30156
    logger.go:54: 2026-02-11 14:36:58.378078588 -0500 EST m=+2.469906137 level info tenant fake msg completed block id 754de9d0-3382-4bb7-b0ef-5d3783b45c27
    logger.go:54: 2026-02-11 14:36:58.386002205 -0500 EST m=+2.477829742 level info tenant fake msg queueing wal block for completion block 892edb0d-9d17-4cf3-8ba0-94e6d83d5da0 size 33463
    logger.go:54: 2026-02-11 14:36:58.410373213 -0500 EST m=+2.502200749 level info tenant fake msg completed block id 892edb0d-9d17-4cf3-8ba0-94e6d83d5da0
    logger.go:54: 2026-02-11 14:36:58.413905804 -0500 EST m=+2.505733341 level warn tenant fake msg Search of tags exceeded limit, reduce cardinality or size of tags orgID test stopReason 
    logger.go:54: 2026-02-11 14:36:58.414007079 -0500 EST m=+2.505834623 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:58.414012708 -0500 EST m=+2.505840240 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:58.414143854 -0500 EST m=+2.505971386 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:58.414004946 -0500 EST m=+2.505832478 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:58.414033324 -0500 EST m=+2.505860857 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:58.414105766 -0500 EST m=+2.505933299 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:58.414194764 -0500 EST m=+2.506022296 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:58.414332019 -0500 EST m=+2.506159550 level info partition 0 msg stopping partition reader
=== RUN   TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=100
    logger.go:54: 2026-02-11 14:36:58.415573317 -0500 EST m=+2.507400850 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:58.415624973 -0500 EST m=+2.507452505 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:58.415698312 -0500 EST m=+2.507525843 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:58.415840999 -0500 EST m=+2.507668536 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:58.416792935 -0500 EST m=+2.508620466 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:58.416820278 -0500 EST m=+2.508647810 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:58.416841218 -0500 EST m=+2.508668750 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:58.417478992 -0500 EST m=+2.509306523 level debug partition 0 msg initial lag calculated lag 0 committed 1770831418417 end 0
    logger.go:54: 2026-02-11 14:36:58.417540876 -0500 EST m=+2.509368408 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:58.417705346 -0500 EST m=+2.509532879 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831418417 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:58.42901028 -0500 EST m=+2.520837830 level info tenant fake msg queueing wal block for completion block 73c60f34-9dc7-4967-8ec9-9b269bac9d65 size 36799
    logger.go:54: 2026-02-11 14:36:58.449727057 -0500 EST m=+2.541554604 level info tenant fake msg completed block id 73c60f34-9dc7-4967-8ec9-9b269bac9d65
    logger.go:54: 2026-02-11 14:36:58.458571618 -0500 EST m=+2.550399165 level info tenant fake msg queueing wal block for completion block fddd3cbb-3101-4785-b8f1-250661d44ca0 size 33000
    logger.go:54: 2026-02-11 14:36:58.477378287 -0500 EST m=+2.569205836 level info tenant fake msg completed block id fddd3cbb-3101-4785-b8f1-250661d44ca0
    logger.go:54: 2026-02-11 14:36:58.489019528 -0500 EST m=+2.580847076 level info tenant fake msg queueing wal block for completion block d9f2d0d2-4727-4838-8ea1-51b4a7c8d90a size 34807
    logger.go:54: 2026-02-11 14:36:58.513389798 -0500 EST m=+2.605217346 level info tenant fake msg completed block id d9f2d0d2-4727-4838-8ea1-51b4a7c8d90a
    logger.go:54: 2026-02-11 14:36:58.522349562 -0500 EST m=+2.614177109 level info tenant fake msg queueing wal block for completion block 05983cdd-16db-45e5-87fb-abc1f22b93e5 size 32641
    logger.go:54: 2026-02-11 14:36:58.543401007 -0500 EST m=+2.635228555 level info tenant fake msg completed block id 05983cdd-16db-45e5-87fb-abc1f22b93e5
    logger.go:54: 2026-02-11 14:36:58.552419469 -0500 EST m=+2.644247017 level info tenant fake msg queueing wal block for completion block 87f370aa-fde0-4443-ad24-dbd916805ea0 size 35997
    logger.go:54: 2026-02-11 14:36:58.572014804 -0500 EST m=+2.663842350 level info tenant fake msg completed block id 87f370aa-fde0-4443-ad24-dbd916805ea0
    logger.go:54: 2026-02-11 14:36:58.579530489 -0500 EST m=+2.671358037 level info tenant fake msg queueing wal block for completion block 2e38ba68-5861-4a3f-af28-bf7c6bad894d size 31872
    logger.go:54: 2026-02-11 14:36:58.60074372 -0500 EST m=+2.692571267 level info tenant fake msg completed block id 2e38ba68-5861-4a3f-af28-bf7c6bad894d
    logger.go:54: 2026-02-11 14:36:58.609189291 -0500 EST m=+2.701016837 level info tenant fake msg queueing wal block for completion block fb4ad510-d505-49be-aba9-cff2a98584e0 size 35854
    logger.go:54: 2026-02-11 14:36:58.628589729 -0500 EST m=+2.720417276 level info tenant fake msg completed block id fb4ad510-d505-49be-aba9-cff2a98584e0
    logger.go:54: 2026-02-11 14:36:58.636301372 -0500 EST m=+2.728128920 level info tenant fake msg queueing wal block for completion block 464b03a5-69a7-496f-a80c-bc021c06c416 size 32788
    logger.go:54: 2026-02-11 14:36:58.655085184 -0500 EST m=+2.746912731 level info tenant fake msg completed block id 464b03a5-69a7-496f-a80c-bc021c06c416
    logger.go:54: 2026-02-11 14:36:58.662155132 -0500 EST m=+2.753982668 level info tenant fake msg queueing wal block for completion block 82c1f6cf-19b6-4ce9-9197-509e72b85284 size 29789
    logger.go:54: 2026-02-11 14:36:58.685891866 -0500 EST m=+2.777719412 level info tenant fake msg completed block id 82c1f6cf-19b6-4ce9-9197-509e72b85284
    logger.go:54: 2026-02-11 14:36:58.693940794 -0500 EST m=+2.785768342 level info tenant fake msg queueing wal block for completion block eafc9e28-d30f-4169-8e2a-a57629f284f9 size 33745
    logger.go:54: 2026-02-11 14:36:58.713293696 -0500 EST m=+2.805121245 level info tenant fake msg completed block id eafc9e28-d30f-4169-8e2a-a57629f284f9
    logger.go:54: 2026-02-11 14:36:58.717224783 -0500 EST m=+2.809052319 level warn tenant fake msg Search of tags exceeded limit, reduce cardinality or size of tags orgID test stopReason 
    logger.go:54: 2026-02-11 14:36:58.717322519 -0500 EST m=+2.809150058 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:58.717330577 -0500 EST m=+2.809158110 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:58.717473722 -0500 EST m=+2.809301255 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:58.717320846 -0500 EST m=+2.809148385 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:58.717337837 -0500 EST m=+2.809165383 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:58.717417862 -0500 EST m=+2.809245401 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:58.717523486 -0500 EST m=+2.809351019 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:36:58.717553286 -0500 EST m=+2.809380819 level info partition 0 msg stopping partition reader
=== RUN   TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=500
    logger.go:54: 2026-02-11 14:36:58.719666022 -0500 EST m=+2.811493554 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:58.71971939 -0500 EST m=+2.811546921 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:58.719793736 -0500 EST m=+2.811621269 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:58.720008519 -0500 EST m=+2.811836058 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:58.721064146 -0500 EST m=+2.812891692 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:58.721108971 -0500 EST m=+2.812936510 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:58.721144463 -0500 EST m=+2.812972002 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:58.721854186 -0500 EST m=+2.813681725 level debug partition 0 msg initial lag calculated lag 0 committed 1770831418721 end 0
    logger.go:54: 2026-02-11 14:36:58.721920352 -0500 EST m=+2.813747897 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:58.722211448 -0500 EST m=+2.814038986 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831418721 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:58.731118245 -0500 EST m=+2.822945794 level info tenant fake msg queueing wal block for completion block ae67ca64-5c62-44e8-8499-82584d7e329a size 35637
    logger.go:54: 2026-02-11 14:36:58.751261907 -0500 EST m=+2.843089457 level info tenant fake msg completed block id ae67ca64-5c62-44e8-8499-82584d7e329a
    logger.go:54: 2026-02-11 14:36:58.759370049 -0500 EST m=+2.851197596 level info tenant fake msg queueing wal block for completion block 10e22077-e662-4898-9734-b8a02adbf42e size 33687
    logger.go:54: 2026-02-11 14:36:58.781660388 -0500 EST m=+2.873487937 level info tenant fake msg completed block id 10e22077-e662-4898-9734-b8a02adbf42e
    logger.go:54: 2026-02-11 14:36:58.789900077 -0500 EST m=+2.881727626 level info tenant fake msg queueing wal block for completion block 52e722b6-12e5-460e-bcc4-681e11cd7d22 size 33466
    logger.go:54: 2026-02-11 14:36:58.809732446 -0500 EST m=+2.901559993 level info tenant fake msg completed block id 52e722b6-12e5-460e-bcc4-681e11cd7d22
    logger.go:54: 2026-02-11 14:36:58.818134999 -0500 EST m=+2.909962547 level info tenant fake msg queueing wal block for completion block afcd507a-e105-4401-93ec-e6241587b8da size 33409
    logger.go:54: 2026-02-11 14:36:58.838080044 -0500 EST m=+2.929907591 level info tenant fake msg completed block id afcd507a-e105-4401-93ec-e6241587b8da
    logger.go:54: 2026-02-11 14:36:58.847326581 -0500 EST m=+2.939154129 level info tenant fake msg queueing wal block for completion block 34802232-c391-459c-9e15-2764dae95754 size 35373
    logger.go:54: 2026-02-11 14:36:58.867922982 -0500 EST m=+2.959750529 level info tenant fake msg completed block id 34802232-c391-459c-9e15-2764dae95754
    logger.go:54: 2026-02-11 14:36:58.878209252 -0500 EST m=+2.970036800 level info tenant fake msg queueing wal block for completion block 8cda8bc1-8189-40fa-a490-32593b627061 size 33532
    logger.go:54: 2026-02-11 14:36:58.89854894 -0500 EST m=+2.990376487 level info tenant fake msg completed block id 8cda8bc1-8189-40fa-a490-32593b627061
    logger.go:54: 2026-02-11 14:36:58.907483685 -0500 EST m=+2.999311232 level info tenant fake msg queueing wal block for completion block 7eeb0a22-dcd5-48ff-965d-937ec33000e3 size 34391
    logger.go:54: 2026-02-11 14:36:58.927366019 -0500 EST m=+3.019193565 level info tenant fake msg completed block id 7eeb0a22-dcd5-48ff-965d-937ec33000e3
    logger.go:54: 2026-02-11 14:36:58.93469525 -0500 EST m=+3.026522788 level info tenant fake msg queueing wal block for completion block 35e8014d-8832-41ec-8336-4f28f5f81c55 size 29722
    logger.go:54: 2026-02-11 14:36:58.952648753 -0500 EST m=+3.044476302 level info tenant fake msg completed block id 35e8014d-8832-41ec-8336-4f28f5f81c55
    logger.go:54: 2026-02-11 14:36:58.960849095 -0500 EST m=+3.052676641 level info tenant fake msg queueing wal block for completion block 9f2d91da-1130-4b01-987c-990e47ab2ff7 size 34371
    logger.go:54: 2026-02-11 14:36:58.983736599 -0500 EST m=+3.075564147 level info tenant fake msg completed block id 9f2d91da-1130-4b01-987c-990e47ab2ff7
    logger.go:54: 2026-02-11 14:36:58.992071917 -0500 EST m=+3.083899457 level info tenant fake msg queueing wal block for completion block b567fab3-fe3a-4005-bd65-acf3624f21c0 size 34864
    logger.go:54: 2026-02-11 14:36:59.012173503 -0500 EST m=+3.104001051 level info tenant fake msg completed block id b567fab3-fe3a-4005-bd65-acf3624f21c0
    logger.go:54: 2026-02-11 14:36:59.016908438 -0500 EST m=+3.108735984 level warn tenant fake msg Search of tags exceeded limit, reduce cardinality or size of tags orgID test stopReason 
    logger.go:54: 2026-02-11 14:36:59.017073335 -0500 EST m=+3.108900875 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:59.017125034 -0500 EST m=+3.108952581 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:59.017206957 -0500 EST m=+3.109034496 level error msg metric lag failed: err fetch offsets: context canceled retries 1
    logger.go:54: 2026-02-11 14:36:59.017081533 -0500 EST m=+3.108909072 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:59.017099655 -0500 EST m=+3.108927194 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:59.017283859 -0500 EST m=+3.109111398 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:59.017478051 -0500 EST m=+3.109305590 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:59.017556624 -0500 EST m=+3.109384163 level info msg instance removed from the ring ring live-store
=== RUN   TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=1000
    logger.go:54: 2026-02-11 14:36:59.01869311 -0500 EST m=+3.110520642 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:59.018756945 -0500 EST m=+3.110584477 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:59.018818774 -0500 EST m=+3.110646306 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:59.018972856 -0500 EST m=+3.110800389 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:59.02016722 -0500 EST m=+3.111994753 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:59.020195193 -0500 EST m=+3.112022726 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:59.020214051 -0500 EST m=+3.112041583 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:59.020793883 -0500 EST m=+3.112621415 level debug partition 0 msg initial lag calculated lag 0 committed 1770831419020 end 0
    logger.go:54: 2026-02-11 14:36:59.020839911 -0500 EST m=+3.112667450 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:59.021164616 -0500 EST m=+3.112992155 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831419020 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:59.029192128 -0500 EST m=+3.121019675 level info tenant fake msg queueing wal block for completion block b0c278a8-3325-48f7-b4f9-dedd258b4cc5 size 31033
    logger.go:54: 2026-02-11 14:36:59.050676513 -0500 EST m=+3.142504060 level info tenant fake msg completed block id b0c278a8-3325-48f7-b4f9-dedd258b4cc5
    logger.go:54: 2026-02-11 14:36:59.058321026 -0500 EST m=+3.150148574 level info tenant fake msg queueing wal block for completion block 31a9afff-c60d-4af6-8d7b-3b498fe0b420 size 32303
    logger.go:54: 2026-02-11 14:36:59.077098697 -0500 EST m=+3.168926244 level info tenant fake msg completed block id 31a9afff-c60d-4af6-8d7b-3b498fe0b420
    logger.go:54: 2026-02-11 14:36:59.084160265 -0500 EST m=+3.175987813 level info tenant fake msg queueing wal block for completion block 7da1160c-79a9-436a-ae0f-54e64b498be2 size 29762
    logger.go:54: 2026-02-11 14:36:59.101997356 -0500 EST m=+3.193824903 level info tenant fake msg completed block id 7da1160c-79a9-436a-ae0f-54e64b498be2
    logger.go:54: 2026-02-11 14:36:59.109249052 -0500 EST m=+3.201076600 level info tenant fake msg queueing wal block for completion block a6efa366-ef17-4a6a-a5b9-cd91d6ec8ca7 size 31105
    logger.go:54: 2026-02-11 14:36:59.127377136 -0500 EST m=+3.219204683 level info tenant fake msg completed block id a6efa366-ef17-4a6a-a5b9-cd91d6ec8ca7
    logger.go:54: 2026-02-11 14:36:59.135834296 -0500 EST m=+3.227661844 level info tenant fake msg queueing wal block for completion block d8ec5efb-03d1-44a3-a221-42a10fde97da size 33283
    logger.go:54: 2026-02-11 14:36:59.157641078 -0500 EST m=+3.249468624 level info tenant fake msg completed block id d8ec5efb-03d1-44a3-a221-42a10fde97da
    logger.go:54: 2026-02-11 14:36:59.165541692 -0500 EST m=+3.257369240 level info tenant fake msg queueing wal block for completion block e6f87157-d447-4298-94f8-f8a9fc60ddfd size 33229
    logger.go:54: 2026-02-11 14:36:59.184395714 -0500 EST m=+3.276223261 level info tenant fake msg completed block id e6f87157-d447-4298-94f8-f8a9fc60ddfd
    logger.go:54: 2026-02-11 14:36:59.193315324 -0500 EST m=+3.285142874 level info tenant fake msg queueing wal block for completion block 27482508-5eae-4ca7-a087-95372aa0a7cc size 36762
    logger.go:54: 2026-02-11 14:36:59.218485136 -0500 EST m=+3.310312682 level info tenant fake msg completed block id 27482508-5eae-4ca7-a087-95372aa0a7cc
    logger.go:54: 2026-02-11 14:36:59.225848829 -0500 EST m=+3.317676365 level info tenant fake msg queueing wal block for completion block 4cce52ad-33d4-4470-b332-c25598f53032 size 31164
    logger.go:54: 2026-02-11 14:36:59.244074932 -0500 EST m=+3.335902479 level info tenant fake msg completed block id 4cce52ad-33d4-4470-b332-c25598f53032
    logger.go:54: 2026-02-11 14:36:59.251729443 -0500 EST m=+3.343556990 level info tenant fake msg queueing wal block for completion block 1a95360a-127e-41af-9255-a4adf07ba712 size 32438
    logger.go:54: 2026-02-11 14:36:59.270097214 -0500 EST m=+3.361924761 level info tenant fake msg completed block id 1a95360a-127e-41af-9255-a4adf07ba712
    logger.go:54: 2026-02-11 14:36:59.278376719 -0500 EST m=+3.370204259 level info tenant fake msg queueing wal block for completion block 0c4f7f04-9dc8-475a-9473-f6aa9e1c6f94 size 33358
    logger.go:54: 2026-02-11 14:36:59.299076627 -0500 EST m=+3.390904163 level info tenant fake msg completed block id 0c4f7f04-9dc8-475a-9473-f6aa9e1c6f94
    logger.go:54: 2026-02-11 14:36:59.309582636 -0500 EST m=+3.401410173 level warn tenant fake msg Search of tags exceeded limit, reduce cardinality or size of tags orgID test stopReason 
    logger.go:54: 2026-02-11 14:36:59.309698209 -0500 EST m=+3.401525746 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:36:59.309723217 -0500 EST m=+3.401550749 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:36:59.309755237 -0500 EST m=+3.401582769 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:36:59.309722268 -0500 EST m=+3.401549800 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:36:59.309757547 -0500 EST m=+3.401585078 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:36:59.309871637 -0500 EST m=+3.401699169 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:36:59.309902334 -0500 EST m=+3.401729869 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:36:59.309927563 -0500 EST m=+3.401755095 level info msg instance removed from the ring ring live-store
--- PASS: TestSearchTagsV2Limits (1.81s)
    --- PASS: TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=0 (0.33s)
    --- PASS: TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=10 (0.29s)
    --- PASS: TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=50 (0.29s)
    --- PASS: TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=100 (0.30s)
    --- PASS: TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=500 (0.30s)
    --- PASS: TestSearchTagsV2Limits/MaxBytesPerTagValuesQuery=1000 (0.29s)
=== RUN   TestInstanceSearchDoesNotRace
    logger.go:54: 2026-02-11 14:36:59.311195312 -0500 EST m=+3.403022845 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:36:59.311260334 -0500 EST m=+3.403087867 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:36:59.311326947 -0500 EST m=+3.403154480 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:36:59.311466785 -0500 EST m=+3.403294317 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:36:59.312453376 -0500 EST m=+3.404280908 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:36:59.312483074 -0500 EST m=+3.404310605 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:36:59.312502287 -0500 EST m=+3.404329819 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:36:59.313145136 -0500 EST m=+3.404972668 level debug partition 0 msg initial lag calculated lag 0 committed 1770831419312 end 0
    logger.go:54: 2026-02-11 14:36:59.31321069 -0500 EST m=+3.405038223 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:36:59.313469369 -0500 EST m=+3.405296901 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831419312 e-1 ce0}]
    logger.go:54: 2026-02-11 14:36:59.33903935 -0500 EST m=+3.430866895 level info tenant fake msg queueing wal block for completion block 8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1 size 55201
    logger.go:54: 2026-02-11 14:36:59.417601761 -0500 EST m=+3.509429299 level error tenant fake msg error in SearchTagValues err processing wal block (8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1): unexpected error searching tag values (foo): error opening file /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: error opening file: open /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: no such file or directory
    instance_search_test.go:790: 
        	Error Trace:	/home/mdurham/source/tempo-worktrees/livestore-review/modules/livestore/instance_search_test.go:790
        	            				/home/mdurham/source/tempo-worktrees/livestore-review/modules/livestore/instance_search_test.go:728
        	            				/home/mdurham/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.25.6.linux-amd64/src/runtime/asm_amd64.s:1693
        	Error:      	Received unexpected error:
        	            	SearchTagValues: processing wal block (8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1): unexpected error searching tag values (foo): error opening file /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: error opening file: open /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: no such file or directory
        	Test:       	TestInstanceSearchDoesNotRace
        	Messages:   	error getting search tag values
    logger.go:54: 2026-02-11 14:36:59.418026876 -0500 EST m=+3.509854414 level error tenant fake msg error in Search err processing wal block (8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1): error opening file /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: error opening file: open /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: no such file or directory
    instance_search_test.go:772: 
        	Error Trace:	/home/mdurham/source/tempo-worktrees/livestore-review/modules/livestore/instance_search_test.go:772
        	            				/home/mdurham/source/tempo-worktrees/livestore-review/modules/livestore/instance_search_test.go:728
        	            				/home/mdurham/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.25.6.linux-amd64/src/runtime/asm_amd64.s:1693
        	Error:      	Received unexpected error:
        	            	Search: processing wal block (8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1): error opening file /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: error opening file: open /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: no such file or directory
        	Test:       	TestInstanceSearchDoesNotRace
        	Messages:   	error searching
    logger.go:54: 2026-02-11 14:36:59.422411999 -0500 EST m=+3.514239544 level error tenant fake msg error in SearchTagsV2 err processing wal block (8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1): error opening file /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: error opening file: open /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: no such file or directory
    instance_search_test.go:779: 
        	Error Trace:	/home/mdurham/source/tempo-worktrees/livestore-review/modules/livestore/instance_search_test.go:779
        	            				/home/mdurham/source/tempo-worktrees/livestore-review/modules/livestore/instance_search_test.go:728
        	            				/home/mdurham/go/pkg/mod/golang.org/toolchain@v0.0.1-go1.25.6.linux-amd64/src/runtime/asm_amd64.s:1693
        	Error:      	Received unexpected error:
        	            	SearchTagsV2: processing wal block (8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1): error opening file /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: error opening file: open /tmp/TestInstanceSearchDoesNotRace2345293523/001/8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1+fake+vParquet4/0000000001: no such file or directory
        	Test:       	TestInstanceSearchDoesNotRace
        	Messages:   	error getting search tags
    logger.go:54: 2026-02-11 14:36:59.427624976 -0500 EST m=+3.519452508 level info tenant fake msg completed block id 8eadcebc-e0d6-4eba-9e9b-8a5cbd12e6d1
    logger.go:54: 2026-02-11 14:36:59.460962873 -0500 EST m=+3.552790420 level info tenant fake msg queueing wal block for completion block 6c0c4702-6812-40d6-83d0-6aaa5ab9a148 size 272539
    logger.go:54: 2026-02-11 14:36:59.556968086 -0500 EST m=+3.648795666 level info tenant fake msg completed block id 6c0c4702-6812-40d6-83d0-6aaa5ab9a148
    logger.go:54: 2026-02-11 14:36:59.582580227 -0500 EST m=+3.674407766 level info tenant fake msg queueing wal block for completion block 48758fb3-b7e4-40a0-bf2e-4e0200e31862 size 621453
    logger.go:54: 2026-02-11 14:36:59.771006286 -0500 EST m=+3.862833824 level info tenant fake msg completed block id 48758fb3-b7e4-40a0-bf2e-4e0200e31862
    logger.go:54: 2026-02-11 14:36:59.802159234 -0500 EST m=+3.893986782 level info tenant fake msg queueing wal block for completion block 04035cf6-8201-4e10-9857-b72d033c8cae size 1023478
    logger.go:54: 2026-02-11 14:37:00.083977554 -0500 EST m=+4.175805093 level info tenant fake msg completed block id 04035cf6-8201-4e10-9857-b72d033c8cae
    logger.go:54: 2026-02-11 14:37:00.115302267 -0500 EST m=+4.207129814 level info tenant fake msg queueing wal block for completion block 091a40eb-709a-41d5-a5d1-bb60f06e8baa size 1434006
    logger.go:54: 2026-02-11 14:37:00.472971976 -0500 EST m=+4.564799508 level info tenant fake msg completed block id 091a40eb-709a-41d5-a5d1-bb60f06e8baa
    logger.go:54: 2026-02-11 14:37:00.503794706 -0500 EST m=+4.595622253 level info tenant fake msg queueing wal block for completion block 5dc15c7e-7625-4bbd-b3ab-33fd667f99c2 size 1941515
    logger.go:54: 2026-02-11 14:37:00.983483099 -0500 EST m=+5.075310638 level info tenant fake msg completed block id 5dc15c7e-7625-4bbd-b3ab-33fd667f99c2
    logger.go:54: 2026-02-11 14:37:01.020611839 -0500 EST m=+5.112439375 level info tenant fake msg queueing wal block for completion block 9a28a439-6da1-4ae2-8312-53bcf32f359a size 2565368
    logger.go:54: 2026-02-11 14:37:01.634110473 -0500 EST m=+5.725938021 level info tenant fake msg completed block id 9a28a439-6da1-4ae2-8312-53bcf32f359a
    logger.go:54: 2026-02-11 14:37:01.636470365 -0500 EST m=+5.728297921 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:01.636473913 -0500 EST m=+5.728301445 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:01.636496427 -0500 EST m=+5.728323984 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:01.636517457 -0500 EST m=+5.728344989 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:01.636547277 -0500 EST m=+5.728374823 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:01.636751071 -0500 EST m=+5.728578610 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:01.636822203 -0500 EST m=+5.728649740 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:01.636852947 -0500 EST m=+5.728680480 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:01.670682544 -0500 EST m=+5.762510091 level info tenant fake msg queueing wal block for completion block 2e4c7811-485b-4800-8df5-9e5816cc64d4 size 1968238
    logger.go:54: 2026-02-11 14:37:01.672247747 -0500 EST m=+5.764075279 level debug msg enqueueing complete op tenant fake block 2e4c7811-485b-4800-8df5-9e5816cc64d4 attempts 0
--- FAIL: TestInstanceSearchDoesNotRace (2.36s)
=== RUN   TestInstanceSearchMetrics
=== PAUSE TestInstanceSearchMetrics
=== RUN   TestInstanceFindByTraceID
    logger.go:54: 2026-02-11 14:37:01.673532402 -0500 EST m=+5.765359934 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:01.673593217 -0500 EST m=+5.765420749 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:01.673696678 -0500 EST m=+5.765524218 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:01.67396331 -0500 EST m=+5.765790860 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:01.675302633 -0500 EST m=+5.767130180 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:01.675345756 -0500 EST m=+5.767173295 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:01.675380817 -0500 EST m=+5.767208356 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:01.676048176 -0500 EST m=+5.767875722 level debug partition 0 msg initial lag calculated lag 0 committed 1770831421675 end 0
    logger.go:54: 2026-02-11 14:37:01.676161875 -0500 EST m=+5.767989421 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:01.676445773 -0500 EST m=+5.768273312 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831421675 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:01.733296594 -0500 EST m=+5.825124149 level info tenant fake msg queueing wal block for completion block 06831b2f-756a-4d5f-b54b-aa5d722c692e size 173451
    logger.go:54: 2026-02-11 14:37:01.804421547 -0500 EST m=+5.896249094 level info tenant fake msg completed block id 06831b2f-756a-4d5f-b54b-aa5d722c692e
    logger.go:54: 2026-02-11 14:37:01.920811207 -0500 EST m=+6.012638746 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:01.920857735 -0500 EST m=+6.012685274 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:01.920825485 -0500 EST m=+6.012653021 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:01.920823795 -0500 EST m=+6.012651341 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:01.920891178 -0500 EST m=+6.012718723 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:01.921159836 -0500 EST m=+6.012987396 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:01.921251415 -0500 EST m=+6.013078954 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:01.921340886 -0500 EST m=+6.013168426 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:01.921708303 -0500 EST m=+6.013535838 level info tenant fake msg queueing wal block for completion block c7325638-06c0-46c0-a03f-4d272697489b size 183537
    logger.go:54: 2026-02-11 14:37:01.923316714 -0500 EST m=+6.015144246 level debug msg enqueueing complete op tenant fake block c7325638-06c0-46c0-a03f-4d272697489b attempts 0
--- PASS: TestInstanceFindByTraceID (0.25s)
=== RUN   TestInstanceFindByTraceIDWithSizeLimits
    logger.go:54: 2026-02-11 14:37:01.924250796 -0500 EST m=+6.016078336 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:01.92435895 -0500 EST m=+6.016186495 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:01.92445945 -0500 EST m=+6.016286988 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:01.924703305 -0500 EST m=+6.016530844 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:01.926301196 -0500 EST m=+6.018128735 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:01.926346513 -0500 EST m=+6.018174052 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:01.926381246 -0500 EST m=+6.018208785 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:01.927331291 -0500 EST m=+6.019158837 level debug partition 0 msg initial lag calculated lag 0 committed 1770831421926 end 0
    logger.go:54: 2026-02-11 14:37:01.927391847 -0500 EST m=+6.019219378 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:01.928473194 -0500 EST m=+6.020300726 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831421926 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.187105501 -0500 EST m=+6.278933049 level error tenant fake msg error in FindTraceByID err processing head block (6487a1fb-766c-4a7b-90bc-0a9006170aed): trace exceeds max size (max bytes: 96950)
    logger.go:54: 2026-02-11 14:37:02.255261935 -0500 EST m=+6.347089475 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.255266071 -0500 EST m=+6.347093618 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.255282571 -0500 EST m=+6.347110119 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.255467152 -0500 EST m=+6.347294691 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.255293139 -0500 EST m=+6.347120676 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.255548963 -0500 EST m=+6.347376508 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.25536298 -0500 EST m=+6.347190512 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.255562975 -0500 EST m=+6.347390511 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.25610149 -0500 EST m=+6.347929023 level info tenant fake msg queueing wal block for completion block 6487a1fb-766c-4a7b-90bc-0a9006170aed size 269628
    logger.go:54: 2026-02-11 14:37:02.257703522 -0500 EST m=+6.349531053 level debug msg enqueueing complete op tenant fake block 6487a1fb-766c-4a7b-90bc-0a9006170aed attempts 0
--- PASS: TestInstanceFindByTraceIDWithSizeLimits (0.33s)
=== RUN   TestIncludeBlock
=== RUN   TestIncludeBlock/100-200-0-0
=== RUN   TestIncludeBlock/100-200-50-99
=== RUN   TestIncludeBlock/100-200-50-150
=== RUN   TestIncludeBlock/100-200-110-150
=== RUN   TestIncludeBlock/100-200-150-250
=== RUN   TestIncludeBlock/100-200-201-250
--- PASS: TestIncludeBlock (0.00s)
    --- PASS: TestIncludeBlock/100-200-0-0 (0.00s)
    --- PASS: TestIncludeBlock/100-200-50-99 (0.00s)
    --- PASS: TestIncludeBlock/100-200-50-150 (0.00s)
    --- PASS: TestIncludeBlock/100-200-110-150 (0.00s)
    --- PASS: TestIncludeBlock/100-200-150-250 (0.00s)
    --- PASS: TestIncludeBlock/100-200-201-250 (0.00s)
=== RUN   TestLiveStoreQueryRange
=== RUN   TestLiveStoreQueryRange/first_trace
=== RUN   TestLiveStoreQueryRange/second_trace
=== RUN   TestLiveStoreQueryRange/start_of_block_included
=== RUN   TestLiveStoreQueryRange/end_of_block_included
--- PASS: TestLiveStoreQueryRange (0.14s)
    --- PASS: TestLiveStoreQueryRange/first_trace (0.00s)
    --- PASS: TestLiveStoreQueryRange/second_trace (0.00s)
    --- PASS: TestLiveStoreQueryRange/start_of_block_included (0.00s)
    --- PASS: TestLiveStoreQueryRange/end_of_block_included (0.00s)
=== RUN   TestInstanceLimits
=== RUN   TestInstanceLimits/bytes_-_succeeds
    logger.go:54: 2026-02-11 14:37:02.404029503 -0500 EST m=+6.495857034 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.404100314 -0500 EST m=+6.495927846 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.404180278 -0500 EST m=+6.496007810 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.404403202 -0500 EST m=+6.496230734 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.405527714 -0500 EST m=+6.497355247 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.405562423 -0500 EST m=+6.497389956 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.405589864 -0500 EST m=+6.497417396 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.406234426 -0500 EST m=+6.498061958 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422406 end 0
    logger.go:54: 2026-02-11 14:37:02.406301653 -0500 EST m=+6.498129200 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.406659476 -0500 EST m=+6.498487016 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422406 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.410458424 -0500 EST m=+6.502285955 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.41048936 -0500 EST m=+6.502316892 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.41050954 -0500 EST m=+6.502337073 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.410486294 -0500 EST m=+6.502313840 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.410591957 -0500 EST m=+6.502419488 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.410637274 -0500 EST m=+6.502464821 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.410674646 -0500 EST m=+6.502502178 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.410591104 -0500 EST m=+6.502418643 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.431285359 -0500 EST m=+6.523112909 level info tenant fake msg queueing wal block for completion block abc93595-553d-4688-9460-57de98e4ac1f size 115976
    logger.go:54: 2026-02-11 14:37:02.432878493 -0500 EST m=+6.524706026 level debug msg enqueueing complete op tenant fake block abc93595-553d-4688-9460-57de98e4ac1f attempts 0
=== RUN   TestInstanceLimits/bytes_-_one_fails
    logger.go:54: 2026-02-11 14:37:02.433722562 -0500 EST m=+6.525550123 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.433823412 -0500 EST m=+6.525650957 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.433927175 -0500 EST m=+6.525754706 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.434126061 -0500 EST m=+6.525953600 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.435393359 -0500 EST m=+6.527220891 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.435424867 -0500 EST m=+6.527252400 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.435445343 -0500 EST m=+6.527272874 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.436385396 -0500 EST m=+6.528212928 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422436 end 0
    logger.go:54: 2026-02-11 14:37:02.436434147 -0500 EST m=+6.528261686 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.436645751 -0500 EST m=+6.528473284 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422436 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.440066783 -0500 EST m=+6.531894315 level warn tenant fake msg TRACE_TOO_LARGE max 78119 traceSz 41609 totalSize 98924 trace e8203fa35c43a9d049d1234daac8e512 insight true
    logger.go:54: 2026-02-11 14:37:02.440184716 -0500 EST m=+6.532012248 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.440198133 -0500 EST m=+6.532025667 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.44020167 -0500 EST m=+6.532029201 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.440276243 -0500 EST m=+6.532103775 level error msg metric lag failed: err fetch offsets: context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.440214863 -0500 EST m=+6.532042396 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.440368338 -0500 EST m=+6.532195877 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.440383201 -0500 EST m=+6.532210734 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.440477111 -0500 EST m=+6.532304651 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.455550802 -0500 EST m=+6.547378350 level info tenant fake msg queueing wal block for completion block 02b6555c-f146-4dc5-9027-ec54084db3aa size 77355
    logger.go:54: 2026-02-11 14:37:02.457134061 -0500 EST m=+6.548961593 level debug msg enqueueing complete op tenant fake block 02b6555c-f146-4dc5-9027-ec54084db3aa attempts 0
=== RUN   TestInstanceLimits/bytes_-_second_push_fails_even_after_cutIdleTraces
    logger.go:54: 2026-02-11 14:37:02.458104908 -0500 EST m=+6.549932440 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.45816807 -0500 EST m=+6.549995602 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.458237432 -0500 EST m=+6.550064964 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.458414959 -0500 EST m=+6.550242492 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.459750698 -0500 EST m=+6.551578237 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.459799441 -0500 EST m=+6.551626980 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.459832867 -0500 EST m=+6.551660406 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.460906913 -0500 EST m=+6.552734445 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422460 end 0
    logger.go:54: 2026-02-11 14:37:02.460967845 -0500 EST m=+6.552795377 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.461192903 -0500 EST m=+6.553020442 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422460 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.479988519 -0500 EST m=+6.571816051 level warn tenant fake msg TRACE_TOO_LARGE max 78119 traceSz 41609 totalSize 98924 trace 673ca5fb02bb0ce21b358e68f41f9742 insight true
    logger.go:54: 2026-02-11 14:37:02.480071502 -0500 EST m=+6.571899033 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.480088517 -0500 EST m=+6.571916049 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.480120081 -0500 EST m=+6.571947614 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.480132002 -0500 EST m=+6.571959543 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.480190998 -0500 EST m=+6.572018530 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.480150656 -0500 EST m=+6.571978203 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.48024942 -0500 EST m=+6.572076953 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.480330774 -0500 EST m=+6.572158310 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.480747796 -0500 EST m=+6.572575333 level info tenant fake msg queueing wal block for completion block 054b4480-829e-420d-917e-1dfedf399326 size 77355
    logger.go:54: 2026-02-11 14:37:02.482298268 -0500 EST m=+6.574125800 level debug msg enqueueing complete op tenant fake block 054b4480-829e-420d-917e-1dfedf399326 attempts 0
=== RUN   TestInstanceLimits/bytes_-_second_push_succeeds_after_cutting_head_block_2x
    logger.go:54: 2026-02-11 14:37:02.482946217 -0500 EST m=+6.574773749 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.483000385 -0500 EST m=+6.574827917 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.483067073 -0500 EST m=+6.574894606 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.483242646 -0500 EST m=+6.575070178 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.48430483 -0500 EST m=+6.576132369 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.484341283 -0500 EST m=+6.576168825 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.48437227 -0500 EST m=+6.576199804 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.48508371 -0500 EST m=+6.576911256 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422484 end 0
    logger.go:54: 2026-02-11 14:37:02.485187333 -0500 EST m=+6.577014864 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.485505204 -0500 EST m=+6.577332737 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422484 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.501874111 -0500 EST m=+6.593701660 level info tenant fake msg queueing wal block for completion block ecaf3b98-c595-40f0-a9a5-9381f5335d62 size 77355
    logger.go:54: 2026-02-11 14:37:02.531927916 -0500 EST m=+6.623755463 level info tenant fake msg completed block id ecaf3b98-c595-40f0-a9a5-9381f5335d62
    logger.go:54: 2026-02-11 14:37:02.547794299 -0500 EST m=+6.639621848 level info tenant fake msg queueing wal block for completion block 7278e5b1-436a-4d78-95ef-a3aade671e59 size 77355
    logger.go:54: 2026-02-11 14:37:02.577733145 -0500 EST m=+6.669560695 level info tenant fake msg completed block id 7278e5b1-436a-4d78-95ef-a3aade671e59
    logger.go:54: 2026-02-11 14:37:02.580174381 -0500 EST m=+6.672001927 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.580175391 -0500 EST m=+6.672002930 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.580289758 -0500 EST m=+6.672117290 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.580189721 -0500 EST m=+6.672017253 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.580199487 -0500 EST m=+6.672027026 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.580482477 -0500 EST m=+6.672310009 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.580546552 -0500 EST m=+6.672374084 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.580599008 -0500 EST m=+6.672426540 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.595494181 -0500 EST m=+6.687321728 level info tenant fake msg queueing wal block for completion block 6a43107e-adce-4371-b42d-311764dbf8e4 size 77355
    logger.go:54: 2026-02-11 14:37:02.597599319 -0500 EST m=+6.689426852 level debug msg enqueueing complete op tenant fake block 6a43107e-adce-4371-b42d-311764dbf8e4 attempts 0
=== RUN   TestInstanceLimits/max_traces_-_too_many
    logger.go:54: 2026-02-11 14:37:02.598397365 -0500 EST m=+6.690224897 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.598462867 -0500 EST m=+6.690290400 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.598526067 -0500 EST m=+6.690353599 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.598718367 -0500 EST m=+6.690545900 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.600114505 -0500 EST m=+6.691942052 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.600165857 -0500 EST m=+6.691993397 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.600215133 -0500 EST m=+6.692042672 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.601072462 -0500 EST m=+6.692900009 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422600 end 0
    logger.go:54: 2026-02-11 14:37:02.601151431 -0500 EST m=+6.692978963 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.601348428 -0500 EST m=+6.693175959 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422600 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.606036185 -0500 EST m=+6.697863718 level debug tenant fake msg dropped spans due to limits tenant fake reason live_traces_exceeded
    logger.go:54: 2026-02-11 14:37:02.606285547 -0500 EST m=+6.698113079 level debug tenant fake msg dropped spans due to limits tenant fake reason live_traces_exceeded
    logger.go:54: 2026-02-11 14:37:02.606803511 -0500 EST m=+6.698631044 level debug tenant fake msg dropped spans due to limits tenant fake reason live_traces_exceeded
    logger.go:54: 2026-02-11 14:37:02.606936277 -0500 EST m=+6.698763810 level debug tenant fake msg dropped spans due to limits tenant fake reason live_traces_exceeded
    logger.go:54: 2026-02-11 14:37:02.607391062 -0500 EST m=+6.699218594 level debug tenant fake msg dropped spans due to limits tenant fake reason live_traces_exceeded
    logger.go:54: 2026-02-11 14:37:02.607770957 -0500 EST m=+6.699598489 level debug tenant fake msg dropped spans due to limits tenant fake reason live_traces_exceeded
    logger.go:54: 2026-02-11 14:37:02.607820937 -0500 EST m=+6.699648469 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.607868579 -0500 EST m=+6.699696111 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.607883592 -0500 EST m=+6.699711124 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.607883722 -0500 EST m=+6.699711254 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.607980825 -0500 EST m=+6.699808358 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.607893709 -0500 EST m=+6.699721242 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.608060357 -0500 EST m=+6.699887890 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.608041363 -0500 EST m=+6.699868896 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.620746894 -0500 EST m=+6.712574431 level info tenant fake msg queueing wal block for completion block 761abc0b-b534-4ab2-8a12-ee51f05480e2 size 52040
    logger.go:54: 2026-02-11 14:37:02.622874415 -0500 EST m=+6.714701948 level debug msg enqueueing complete op tenant fake block 761abc0b-b534-4ab2-8a12-ee51f05480e2 attempts 0
--- PASS: TestInstanceLimits (0.22s)
    --- PASS: TestInstanceLimits/bytes_-_succeeds (0.03s)
    --- PASS: TestInstanceLimits/bytes_-_one_fails (0.02s)
    --- PASS: TestInstanceLimits/bytes_-_second_push_fails_even_after_cutIdleTraces (0.03s)
    --- PASS: TestInstanceLimits/bytes_-_second_push_succeeds_after_cutting_head_block_2x (0.12s)
    --- PASS: TestInstanceLimits/max_traces_-_too_many (0.03s)
=== RUN   TestTraceTooLargeLogContainsInsight
    logger.go:54: 2026-02-11 14:37:02.623834903 -0500 EST m=+6.715662438 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.623905816 -0500 EST m=+6.715733353 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.623981875 -0500 EST m=+6.715809408 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.624197022 -0500 EST m=+6.716024560 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.625428667 -0500 EST m=+6.717256201 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.625463051 -0500 EST m=+6.717290584 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.625484216 -0500 EST m=+6.717311749 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.626471695 -0500 EST m=+6.718299234 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422626 end 0
    logger.go:54: 2026-02-11 14:37:02.62655078 -0500 EST m=+6.718378319 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.626825079 -0500 EST m=+6.718652618 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422626 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.627804061 -0500 EST m=+6.719631594 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.627843528 -0500 EST m=+6.719671067 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.627826312 -0500 EST m=+6.719653851 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.627825543 -0500 EST m=+6.719653083 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.627900142 -0500 EST m=+6.719727673 level error msg metric lag failed: err fetch offsets: context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.62791916 -0500 EST m=+6.719746705 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.628130161 -0500 EST m=+6.719957700 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.628216392 -0500 EST m=+6.720043939 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.639460323 -0500 EST m=+6.731287869 level info tenant fake msg queueing wal block for completion block 5812ee0e-6802-42ff-860e-11a0fa3e797b size 32120
    logger.go:54: 2026-02-11 14:37:02.641567807 -0500 EST m=+6.733395341 level debug msg enqueueing complete op tenant fake block 5812ee0e-6802-42ff-860e-11a0fa3e797b attempts 0
--- PASS: TestTraceTooLargeLogContainsInsight (0.02s)
=== RUN   TestInstanceNoLimits
    logger.go:54: 2026-02-11 14:37:02.642350195 -0500 EST m=+6.734177727 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.642411926 -0500 EST m=+6.734239458 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.642486394 -0500 EST m=+6.734313925 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.642696897 -0500 EST m=+6.734524436 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.644177864 -0500 EST m=+6.736005396 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.644208742 -0500 EST m=+6.736036274 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.644232463 -0500 EST m=+6.736059995 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.645004127 -0500 EST m=+6.736831659 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422644 end 0
    logger.go:54: 2026-02-11 14:37:02.645068628 -0500 EST m=+6.736896161 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.645257486 -0500 EST m=+6.737085026 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422644 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:02.677726164 -0500 EST m=+6.769553695 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:02.67777822 -0500 EST m=+6.769605751 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:02.677752627 -0500 EST m=+6.769580159 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:02.677760973 -0500 EST m=+6.769588504 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:02.677783327 -0500 EST m=+6.769610860 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:02.678066018 -0500 EST m=+6.769893566 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:02.67808075 -0500 EST m=+6.769908284 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.678243309 -0500 EST m=+6.770070842 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:02.74090355 -0500 EST m=+6.832731087 level info tenant fake msg queueing wal block for completion block 5a875637-ee30-4e22-b8f1-4a0ba737ba5c size 349286
    logger.go:54: 2026-02-11 14:37:02.74301258 -0500 EST m=+6.834840113 level debug msg enqueueing complete op tenant fake block 5a875637-ee30-4e22-b8f1-4a0ba737ba5c attempts 0
--- PASS: TestInstanceNoLimits (0.10s)
=== RUN   TestInstanceBackpressure
    logger.go:54: 2026-02-11 14:37:02.743863399 -0500 EST m=+6.835690935 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:02.74393163 -0500 EST m=+6.835759167 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:02.744007926 -0500 EST m=+6.835835458 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:02.744216881 -0500 EST m=+6.836044412 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:02.74550143 -0500 EST m=+6.837328962 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:02.745532273 -0500 EST m=+6.837359806 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:02.745554747 -0500 EST m=+6.837382279 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:02.746203759 -0500 EST m=+6.838031291 level debug partition 0 msg initial lag calculated lag 0 committed 1770831422745 end 0
    logger.go:54: 2026-02-11 14:37:02.74626874 -0500 EST m=+6.838096279 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:02.746561398 -0500 EST m=+6.838388930 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831422745 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:03.748469683 -0500 EST m=+7.840297217 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:03.748507659 -0500 EST m=+7.840335192 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:03.748549819 -0500 EST m=+7.840377369 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:03.748519191 -0500 EST m=+7.840346724 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:03.748611273 -0500 EST m=+7.840438820 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:03.74864872 -0500 EST m=+7.840476253 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:03.748738452 -0500 EST m=+7.840566008 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:03.748764699 -0500 EST m=+7.840592231 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:03.761451194 -0500 EST m=+7.853278729 level info tenant fake msg queueing wal block for completion block 10c69da8-b898-4569-bcbf-7cd1f69c5373 size 66519
    logger.go:54: 2026-02-11 14:37:03.763055929 -0500 EST m=+7.854883461 level debug msg enqueueing complete op tenant fake block 10c69da8-b898-4569-bcbf-7cd1f69c5373 attempts 0
--- PASS: TestInstanceBackpressure (1.02s)
=== RUN   TestScheduleRetry_ShutdownDuringDelay
--- PASS: TestScheduleRetry_ShutdownDuringDelay (0.10s)
=== RUN   TestEnqueueOpWithJitter_ShutdownDuringDelay
--- PASS: TestEnqueueOpWithJitter_ShutdownDuringDelay (0.05s)
=== RUN   TestLiveStore_NoGoroutineLeaksAfterShutdown
--- PASS: TestLiveStore_NoGoroutineLeaksAfterShutdown (0.00s)
=== RUN   TestConsume_GracefulShutdown_ReturnsNilError
    logger.go:54: 2026-02-11 14:37:03.923235255 -0500 EST m=+8.015062788 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:03.923309442 -0500 EST m=+8.015136974 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:03.923382923 -0500 EST m=+8.015210455 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:03.923608911 -0500 EST m=+8.015436442 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:03.92490191 -0500 EST m=+8.016729456 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:03.924958563 -0500 EST m=+8.016786102 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:03.92499459 -0500 EST m=+8.016822129 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:03.926237034 -0500 EST m=+8.018064565 level info msg consume loop cancelled by context processed_records 0
    logger.go:54: 2026-02-11 14:37:03.926380927 -0500 EST m=+8.018208473 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:03.926380845 -0500 EST m=+8.018208391 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:03.926384076 -0500 EST m=+8.018211615 level debug partition 0 msg initial lag calculated lag 0 committed 1770831423925 end 0
    logger.go:54: 2026-02-11 14:37:03.926556877 -0500 EST m=+8.018384416 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:03.92648431 -0500 EST m=+8.018311849 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:03.926583222 -0500 EST m=+8.018410759 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:03.926749836 -0500 EST m=+8.018577389 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:03.926598388 -0500 EST m=+8.018425920 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:03.926606115 -0500 EST m=+8.018433661 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:03.92664258 -0500 EST m=+8.018470120 level info msg instance removed from the ring ring live-store
--- PASS: TestConsume_GracefulShutdown_ReturnsNilError (0.00s)
=== RUN   TestConsume_GracefulShutdown_MidBatch
    logger.go:54: 2026-02-11 14:37:03.928242734 -0500 EST m=+8.020070274 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:03.928336527 -0500 EST m=+8.020164073 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:03.928428782 -0500 EST m=+8.020256321 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:03.9286382 -0500 EST m=+8.020465739 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:03.930154877 -0500 EST m=+8.021982423 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:03.930199737 -0500 EST m=+8.022027277 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:03.930238598 -0500 EST m=+8.022066136 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:03.931320315 -0500 EST m=+8.023147862 level debug partition 0 msg initial lag calculated lag 0 committed 1770831423930 end 0
    logger.go:54: 2026-02-11 14:37:03.931421304 -0500 EST m=+8.023248842 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:03.931664212 -0500 EST m=+8.023491744 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831423930 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.037310723 -0500 EST m=+8.129138259 level info msg consume loop cancelled by context processed_records 31
    live_store_graceful_shutdown_test.go:125: No records processed before shutdown
    logger.go:54: 2026-02-11 14:37:04.03739116 -0500 EST m=+8.129218699 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.037446333 -0500 EST m=+8.129273880 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.037513341 -0500 EST m=+8.129340887 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.037396978 -0500 EST m=+8.129224525 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.037400279 -0500 EST m=+8.129227813 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.037580985 -0500 EST m=+8.129408524 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.037738913 -0500 EST m=+8.129566452 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.037589008 -0500 EST m=+8.129416554 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.118967765 -0500 EST m=+8.210795313 level info tenant fake msg queueing wal block for completion block e2c1232c-bf14-43bc-9e11-32ac53546a63 size 473429
    logger.go:54: 2026-02-11 14:37:04.120618544 -0500 EST m=+8.212446075 level debug msg enqueueing complete op tenant fake block e2c1232c-bf14-43bc-9e11-32ac53546a63 attempts 0
--- PASS: TestConsume_GracefulShutdown_MidBatch (0.19s)
=== RUN   TestOrphanCleanup_ConcurrentCompletion
--- PASS: TestOrphanCleanup_ConcurrentCompletion (0.00s)
=== RUN   TestOrphanCleanup_ReverificationBeforeDelete
--- PASS: TestOrphanCleanup_ReverificationBeforeDelete (0.00s)
=== RUN   TestOrphanCleanup_TrueOrphansAreDetected
--- PASS: TestOrphanCleanup_TrueOrphansAreDetected (0.00s)
=== RUN   TestCheckReady_NilPointerPanic
--- PASS: TestCheckReady_NilPointerPanic (0.00s)
=== RUN   TestCheckReady_StateTransitions
--- PASS: TestCheckReady_StateTransitions (0.00s)
=== RUN   TestCheckReady_ConcurrentAccess
--- PASS: TestCheckReady_ConcurrentAccess (0.00s)
=== RUN   TestCheckReady_WithAtomicError
--- PASS: TestCheckReady_WithAtomicError (0.00s)
=== RUN   TestLiveStoreBasicConsume
    logger.go:54: 2026-02-11 14:37:04.122101976 -0500 EST m=+8.213929508 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.122167778 -0500 EST m=+8.213995309 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.122256987 -0500 EST m=+8.214084527 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.122569662 -0500 EST m=+8.214397202 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.124188142 -0500 EST m=+8.216015675 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.12421913 -0500 EST m=+8.216046662 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.124239264 -0500 EST m=+8.216066795 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.125182301 -0500 EST m=+8.217009833 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424124 end 0
    logger.go:54: 2026-02-11 14:37:04.125250514 -0500 EST m=+8.217078047 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.125435054 -0500 EST m=+8.217262586 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424124 e-1 ce0}]
--- PASS: TestLiveStoreBasicConsume (0.04s)
=== RUN   TestLiveStoreFullBlockLifecycleCheating
    logger.go:54: 2026-02-11 14:37:04.161053591 -0500 EST m=+8.252881153 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.161167455 -0500 EST m=+8.252994995 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.161267483 -0500 EST m=+8.253095022 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.161551682 -0500 EST m=+8.253379221 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.163087435 -0500 EST m=+8.254914974 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.163139257 -0500 EST m=+8.254966796 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.163175201 -0500 EST m=+8.255002740 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.1645204 -0500 EST m=+8.256347946 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424164 end 0
    logger.go:54: 2026-02-11 14:37:04.164620491 -0500 EST m=+8.256448030 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.16491284 -0500 EST m=+8.256740379 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424164 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.217152292 -0500 EST m=+8.308979840 level info tenant fake msg queueing wal block for completion block 6f42a248-efb2-44cc-8835-208c37085f99 size 45409
    logger.go:54: 2026-02-11 14:37:04.265763638 -0500 EST m=+8.357591185 level info tenant fake msg completed block id 6f42a248-efb2-44cc-8835-208c37085f99
    logger.go:54: 2026-02-11 14:37:04.342495879 -0500 EST m=+8.434323411 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.342496796 -0500 EST m=+8.434324328 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.342508945 -0500 EST m=+8.434336477 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.342518395 -0500 EST m=+8.434345926 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.342534415 -0500 EST m=+8.434361947 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.342614619 -0500 EST m=+8.434442150 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.342766307 -0500 EST m=+8.434593846 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.342854514 -0500 EST m=+8.434682060 level info msg instance removed from the ring ring live-store
--- PASS: TestLiveStoreFullBlockLifecycleCheating (0.18s)
=== RUN   TestLiveStoreReplaysTraceInLiveTraces
    logger.go:54: 2026-02-11 14:37:04.343872965 -0500 EST m=+8.435700498 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.343938969 -0500 EST m=+8.435766501 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.344004158 -0500 EST m=+8.435831691 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.344207435 -0500 EST m=+8.436034966 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.345192753 -0500 EST m=+8.437020285 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.345222715 -0500 EST m=+8.437050248 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.345248804 -0500 EST m=+8.437076335 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.345826425 -0500 EST m=+8.437653957 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424345 end 0
    logger.go:54: 2026-02-11 14:37:04.345886267 -0500 EST m=+8.437713814 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.346165215 -0500 EST m=+8.437992755 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424345 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.348105438 -0500 EST m=+8.439932973 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.348140757 -0500 EST m=+8.439968303 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.348198613 -0500 EST m=+8.440026145 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.348229884 -0500 EST m=+8.440057416 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.348252726 -0500 EST m=+8.440080265 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.348291471 -0500 EST m=+8.440119004 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.348104992 -0500 EST m=+8.439932524 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.348111199 -0500 EST m=+8.439938731 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.359251716 -0500 EST m=+8.451079263 level info tenant fake msg queueing wal block for completion block bdf55d22-8927-49fd-9445-e2ef6f998e07 size 42553
    logger.go:54: 2026-02-11 14:37:04.36090601 -0500 EST m=+8.452733542 level debug msg enqueueing complete op tenant fake block bdf55d22-8927-49fd-9445-e2ef6f998e07 attempts 0
    logger.go:54: 2026-02-11 14:37:04.361416462 -0500 EST m=+8.453243999 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.361490109 -0500 EST m=+8.453317641 level info msg beginning replay file bdf55d22-8927-49fd-9445-e2ef6f998e07+fake+vParquet4 size 100
    logger.go:54: 2026-02-11 14:37:04.365338044 -0500 EST m=+8.457165591 level info msg replay complete file bdf55d22-8927-49fd-9445-e2ef6f998e07+fake+vParquet4 duration 3.851578ms
    logger.go:54: 2026-02-11 14:37:04.365405575 -0500 EST m=+8.457233108 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.36545097 -0500 EST m=+8.457278502 level info msg beginning replay file dc957443-2688-49ab-bbbe-2bce14cd54b0+fake+vParquet4 size 60
    logger.go:54: 2026-02-11 14:37:04.365498025 -0500 EST m=+8.457325558 level warn msg failed to replay block. removing. file dc957443-2688-49ab-bbbe-2bce14cd54b0+fake+vParquet4 err error reading wal meta json: /tmp/TestLiveStoreReplaysTraceInLiveTraces3691436865/001/dc957443-2688-49ab-bbbe-2bce14cd54b0+fake+vParquet4/meta.json: open /tmp/TestLiveStoreReplaysTraceInLiveTraces3691436865/001/dc957443-2688-49ab-bbbe-2bce14cd54b0+fake+vParquet4/meta.json: no such file or directory
    logger.go:54: 2026-02-11 14:37:04.367206193 -0500 EST m=+8.459033725 level info msg reloaded wal block block bdf55d22-8927-49fd-9445-e2ef6f998e07
    logger.go:54: 2026-02-11 14:37:04.367247055 -0500 EST m=+8.459074588 level info msg queueing replayed wal block for completion block bdf55d22-8927-49fd-9445-e2ef6f998e07
    logger.go:54: 2026-02-11 14:37:04.367285997 -0500 EST m=+8.459113529 level info msg reloaded wal blocks tenant fake count 1
    logger.go:54: 2026-02-11 14:37:04.367376292 -0500 EST m=+8.459203824 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.367585546 -0500 EST m=+8.459413078 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.368878651 -0500 EST m=+8.460706184 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.368922635 -0500 EST m=+8.460750169 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.368956054 -0500 EST m=+8.460783587 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.369361192 -0500 EST m=+8.461188732 level debug msg enqueueing complete op tenant fake block bdf55d22-8927-49fd-9445-e2ef6f998e07 attempts 0
    logger.go:54: 2026-02-11 14:37:04.369780262 -0500 EST m=+8.461607801 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424369 end 0
    logger.go:54: 2026-02-11 14:37:04.369867927 -0500 EST m=+8.461695460 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.370038511 -0500 EST m=+8.461866043 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424369 e-1 ce0}]
--- PASS: TestLiveStoreReplaysTraceInLiveTraces (0.04s)
=== RUN   TestLiveStoreReplaysTraceInHeadBlock
    logger.go:54: 2026-02-11 14:37:04.385280203 -0500 EST m=+8.477107739 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.385355944 -0500 EST m=+8.477183481 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.38543005 -0500 EST m=+8.477257582 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.385639226 -0500 EST m=+8.477466759 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.386758212 -0500 EST m=+8.478585745 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.38679248 -0500 EST m=+8.478620012 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.386814177 -0500 EST m=+8.478641710 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.387459195 -0500 EST m=+8.479286728 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424387 end 0
    logger.go:54: 2026-02-11 14:37:04.387520405 -0500 EST m=+8.479347939 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.387716029 -0500 EST m=+8.479543562 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424387 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.399626728 -0500 EST m=+8.491454277 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.399698161 -0500 EST m=+8.491525693 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.399634913 -0500 EST m=+8.491462450 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.399634545 -0500 EST m=+8.491462085 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.399645388 -0500 EST m=+8.491472934 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.39972562 -0500 EST m=+8.491553152 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.399974487 -0500 EST m=+8.491802026 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.400055318 -0500 EST m=+8.491882864 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.400216204 -0500 EST m=+8.492043743 level info tenant fake msg queueing wal block for completion block eb8965a1-86c6-456f-9756-e391e340b34b size 44582
    logger.go:54: 2026-02-11 14:37:04.401963953 -0500 EST m=+8.493791485 level debug msg enqueueing complete op tenant fake block eb8965a1-86c6-456f-9756-e391e340b34b attempts 0
    logger.go:54: 2026-02-11 14:37:04.402561404 -0500 EST m=+8.494388936 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.402625601 -0500 EST m=+8.494453132 level info msg beginning replay file 159cbd4d-a0e4-44b6-94ca-768c9a88a229+fake+vParquet4 size 60
    logger.go:54: 2026-02-11 14:37:04.402682413 -0500 EST m=+8.494509947 level warn msg failed to replay block. removing. file 159cbd4d-a0e4-44b6-94ca-768c9a88a229+fake+vParquet4 err error reading wal meta json: /tmp/TestLiveStoreReplaysTraceInHeadBlock3374425558/001/159cbd4d-a0e4-44b6-94ca-768c9a88a229+fake+vParquet4/meta.json: open /tmp/TestLiveStoreReplaysTraceInHeadBlock3374425558/001/159cbd4d-a0e4-44b6-94ca-768c9a88a229+fake+vParquet4/meta.json: no such file or directory
    logger.go:54: 2026-02-11 14:37:04.402753291 -0500 EST m=+8.494580823 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.402781697 -0500 EST m=+8.494609228 level info msg beginning replay file eb8965a1-86c6-456f-9756-e391e340b34b+fake+vParquet4 size 100
    logger.go:54: 2026-02-11 14:37:04.405603281 -0500 EST m=+8.497430818 level info msg replay complete file eb8965a1-86c6-456f-9756-e391e340b34b+fake+vParquet4 duration 2.824146ms
    logger.go:54: 2026-02-11 14:37:04.407466962 -0500 EST m=+8.499294494 level info msg reloaded wal block block eb8965a1-86c6-456f-9756-e391e340b34b
    logger.go:54: 2026-02-11 14:37:04.407524762 -0500 EST m=+8.499352294 level info msg queueing replayed wal block for completion block eb8965a1-86c6-456f-9756-e391e340b34b
    logger.go:54: 2026-02-11 14:37:04.407548305 -0500 EST m=+8.499375836 level info msg reloaded wal blocks tenant fake count 1
    logger.go:54: 2026-02-11 14:37:04.407650747 -0500 EST m=+8.499478279 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.407835149 -0500 EST m=+8.499662682 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.409174033 -0500 EST m=+8.501001571 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.40922941 -0500 EST m=+8.501056949 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.409268309 -0500 EST m=+8.501095848 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.410073408 -0500 EST m=+8.501900947 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424409 end 0
    logger.go:54: 2026-02-11 14:37:04.410190423 -0500 EST m=+8.502017955 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.41036934 -0500 EST m=+8.502196872 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424409 e-1 ce0}]
--- PASS: TestLiveStoreReplaysTraceInHeadBlock (0.04s)
=== RUN   TestLiveStoreReplaysTraceInWalBlocks
    logger.go:54: 2026-02-11 14:37:04.425216311 -0500 EST m=+8.517043843 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.425297347 -0500 EST m=+8.517124879 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.425385644 -0500 EST m=+8.517213183 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.425625479 -0500 EST m=+8.517453017 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.427249021 -0500 EST m=+8.519076571 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.427319368 -0500 EST m=+8.519146909 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.427359959 -0500 EST m=+8.519187499 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.428382 -0500 EST m=+8.520209532 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424427 end 0
    logger.go:54: 2026-02-11 14:37:04.428444899 -0500 EST m=+8.520272445 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.428733831 -0500 EST m=+8.520561371 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424427 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.43952869 -0500 EST m=+8.531356237 level info tenant fake msg queueing wal block for completion block 74b1bd5e-73a4-4341-87bf-bf99ac669421 size 40338
    logger.go:54: 2026-02-11 14:37:04.441149084 -0500 EST m=+8.532976617 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.441174391 -0500 EST m=+8.533001923 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.441263355 -0500 EST m=+8.533090890 level error msg metric lag failed: err fetch offsets: context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.441179059 -0500 EST m=+8.533006598 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.44119293 -0500 EST m=+8.533020469 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.441279726 -0500 EST m=+8.533107259 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.44139666 -0500 EST m=+8.533224198 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.441547475 -0500 EST m=+8.533375013 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.442302157 -0500 EST m=+8.534129689 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.442364243 -0500 EST m=+8.534191774 level info msg beginning replay file 6f72ba54-d126-457d-bd38-205cd8385b76+fake+vParquet4 size 60
    logger.go:54: 2026-02-11 14:37:04.442415245 -0500 EST m=+8.534242777 level warn msg failed to replay block. removing. file 6f72ba54-d126-457d-bd38-205cd8385b76+fake+vParquet4 err error reading wal meta json: /tmp/TestLiveStoreReplaysTraceInWalBlocks2661376532/001/6f72ba54-d126-457d-bd38-205cd8385b76+fake+vParquet4/meta.json: open /tmp/TestLiveStoreReplaysTraceInWalBlocks2661376532/001/6f72ba54-d126-457d-bd38-205cd8385b76+fake+vParquet4/meta.json: no such file or directory
    logger.go:54: 2026-02-11 14:37:04.442478862 -0500 EST m=+8.534306393 level info msg beginning replay file 74b1bd5e-73a4-4341-87bf-bf99ac669421+fake+vParquet4 size 100
    logger.go:54: 2026-02-11 14:37:04.445162543 -0500 EST m=+8.536990075 level info msg replay complete file 74b1bd5e-73a4-4341-87bf-bf99ac669421+fake+vParquet4 duration 2.687418ms
    logger.go:54: 2026-02-11 14:37:04.445205346 -0500 EST m=+8.537032878 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.446715454 -0500 EST m=+8.538542985 level info msg reloaded wal block block 74b1bd5e-73a4-4341-87bf-bf99ac669421
    logger.go:54: 2026-02-11 14:37:04.446744484 -0500 EST m=+8.538572016 level info msg queueing replayed wal block for completion block 74b1bd5e-73a4-4341-87bf-bf99ac669421
    logger.go:54: 2026-02-11 14:37:04.446772358 -0500 EST m=+8.538599890 level info msg reloaded wal blocks tenant fake count 1
    logger.go:54: 2026-02-11 14:37:04.446854449 -0500 EST m=+8.538681981 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.447080072 -0500 EST m=+8.538907605 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.448137564 -0500 EST m=+8.539965096 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.448167506 -0500 EST m=+8.539995039 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.448186563 -0500 EST m=+8.540014096 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.449208922 -0500 EST m=+8.541036454 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424448 end 0
    logger.go:54: 2026-02-11 14:37:04.449257449 -0500 EST m=+8.541084982 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.449468622 -0500 EST m=+8.541296162 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424448 e-1 ce0}]
--- PASS: TestLiveStoreReplaysTraceInWalBlocks (0.04s)
=== RUN   TestLiveStoreReplaysTraceInCompleteBlocks
    logger.go:54: 2026-02-11 14:37:04.460551956 -0500 EST m=+8.552379489 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.460613615 -0500 EST m=+8.552441147 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.46067375 -0500 EST m=+8.552501282 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.460881957 -0500 EST m=+8.552709489 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.461916351 -0500 EST m=+8.553743882 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.461946938 -0500 EST m=+8.553774471 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.461974833 -0500 EST m=+8.553802366 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.462655638 -0500 EST m=+8.554483184 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424462 end 0
    logger.go:54: 2026-02-11 14:37:04.46275902 -0500 EST m=+8.554586559 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.463053065 -0500 EST m=+8.554880604 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424462 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.47816494 -0500 EST m=+8.569992486 level info tenant fake msg queueing wal block for completion block 919c4f41-982f-4b7f-9419-e8ab0af7f2bf size 40347
    logger.go:54: 2026-02-11 14:37:04.503225668 -0500 EST m=+8.595053215 level info tenant fake msg completed block id 919c4f41-982f-4b7f-9419-e8ab0af7f2bf
    logger.go:54: 2026-02-11 14:37:04.503676512 -0500 EST m=+8.595504044 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.50369521 -0500 EST m=+8.595522742 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.5037304 -0500 EST m=+8.595557932 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.503720535 -0500 EST m=+8.595548067 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.50375255 -0500 EST m=+8.595580083 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.503862444 -0500 EST m=+8.595689990 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.503824962 -0500 EST m=+8.595652494 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.50394788 -0500 EST m=+8.595775420 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.504839949 -0500 EST m=+8.596667481 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.504901919 -0500 EST m=+8.596729452 level info msg beginning replay file 48bd9287-2a25-4657-9e62-eca5103d7ca3+fake+vParquet4 size 60
    logger.go:54: 2026-02-11 14:37:04.504951707 -0500 EST m=+8.596779240 level warn msg failed to replay block. removing. file 48bd9287-2a25-4657-9e62-eca5103d7ca3+fake+vParquet4 err error reading wal meta json: /tmp/TestLiveStoreReplaysTraceInCompleteBlocks2981516223/001/48bd9287-2a25-4657-9e62-eca5103d7ca3+fake+vParquet4/meta.json: open /tmp/TestLiveStoreReplaysTraceInCompleteBlocks2981516223/001/48bd9287-2a25-4657-9e62-eca5103d7ca3+fake+vParquet4/meta.json: no such file or directory
    logger.go:54: 2026-02-11 14:37:04.505014195 -0500 EST m=+8.596841727 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.505091691 -0500 EST m=+8.596919223 level info msg reloading complete blocks tenant fake count 1
    logger.go:54: 2026-02-11 14:37:04.50511163 -0500 EST m=+8.596939162 level info msg reloading complete block block 919c4f41-982f-4b7f-9419-e8ab0af7f2bf
    logger.go:54: 2026-02-11 14:37:04.505241555 -0500 EST m=+8.597069087 level info msg reloaded complete block block 919c4f41-982f-4b7f-9419-e8ab0af7f2bf
    logger.go:54: 2026-02-11 14:37:04.506869243 -0500 EST m=+8.598696775 level info msg scanning for orphaned complete blocks tenant fake
    logger.go:54: 2026-02-11 14:37:04.506975277 -0500 EST m=+8.598802809 level debug msg identified potential orphan candidates count 0 tenant fake
    logger.go:54: 2026-02-11 14:37:04.50703979 -0500 EST m=+8.598867329 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.507302736 -0500 EST m=+8.599130268 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.508884799 -0500 EST m=+8.600712347 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.508935447 -0500 EST m=+8.600762986 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.508975902 -0500 EST m=+8.600803440 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.510123154 -0500 EST m=+8.601950686 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424509 end 0
    logger.go:54: 2026-02-11 14:37:04.51018432 -0500 EST m=+8.602011852 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.510621079 -0500 EST m=+8.602448610 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424509 e-1 ce0}]
--- PASS: TestLiveStoreReplaysTraceInCompleteBlocks (0.07s)
=== RUN   TestLiveStoreConsumeDropsOldRecords
    logger.go:54: 2026-02-11 14:37:04.52795429 -0500 EST m=+8.619781822 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.528042224 -0500 EST m=+8.619869757 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.528115705 -0500 EST m=+8.619943237 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.52829023 -0500 EST m=+8.620117762 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.52969177 -0500 EST m=+8.621519302 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.52972741 -0500 EST m=+8.621554942 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.529749022 -0500 EST m=+8.621576554 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.530455539 -0500 EST m=+8.622283071 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424530 end 0
    logger.go:54: 2026-02-11 14:37:04.530517819 -0500 EST m=+8.622345352 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.530719491 -0500 EST m=+8.622547023 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424530 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.538340495 -0500 EST m=+8.630168027 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.538338978 -0500 EST m=+8.630166516 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.538411973 -0500 EST m=+8.630239512 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.538383137 -0500 EST m=+8.630210676 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.538406907 -0500 EST m=+8.630234446 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.538510343 -0500 EST m=+8.630337875 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.5386157 -0500 EST m=+8.630443253 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.538655334 -0500 EST m=+8.630482867 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.548345798 -0500 EST m=+8.640173345 level info tenant tenant1 msg queueing wal block for completion block 94da1191-9c31-4841-8139-420cdd165873 size 42837
    logger.go:54: 2026-02-11 14:37:04.550053445 -0500 EST m=+8.641880978 level debug msg enqueueing complete op tenant tenant1 block 94da1191-9c31-4841-8139-420cdd165873 attempts 0
    logger.go:54: 2026-02-11 14:37:04.561104085 -0500 EST m=+8.652931621 level info tenant tenant2 msg queueing wal block for completion block c8c0ba3e-9644-4dce-9843-e5cc5b365421 size 45904
    logger.go:54: 2026-02-11 14:37:04.562692161 -0500 EST m=+8.654519695 level debug msg enqueueing complete op tenant tenant2 block c8c0ba3e-9644-4dce-9843-e5cc5b365421 attempts 0
--- PASS: TestLiveStoreConsumeDropsOldRecords (0.04s)
=== RUN   TestLiveStoreUsesRecordTimestampForBlockStartAndEnd
    logger.go:54: 2026-02-11 14:37:04.563583765 -0500 EST m=+8.655411302 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.563659859 -0500 EST m=+8.655487392 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.563747501 -0500 EST m=+8.655575034 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.563915705 -0500 EST m=+8.655743243 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.565647181 -0500 EST m=+8.657474719 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.56568533 -0500 EST m=+8.657512863 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.565708465 -0500 EST m=+8.657535998 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.566588962 -0500 EST m=+8.658416509 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424566 end 0
    logger.go:54: 2026-02-11 14:37:04.566659123 -0500 EST m=+8.658486656 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.566884931 -0500 EST m=+8.658712470 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424566 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.574879102 -0500 EST m=+8.666706638 level info tenant fake msg queueing wal block for completion block f5766837-c233-462f-9b57-665c57fa1bec size 29237
    logger.go:54: 2026-02-11 14:37:04.594994705 -0500 EST m=+8.686822251 level info tenant fake msg completed block id f5766837-c233-462f-9b57-665c57fa1bec
    logger.go:54: 2026-02-11 14:37:04.595522279 -0500 EST m=+8.687349819 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.595521907 -0500 EST m=+8.687349454 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.595521766 -0500 EST m=+8.687349300 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.595545693 -0500 EST m=+8.687373226 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.59571599 -0500 EST m=+8.687543527 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.595762391 -0500 EST m=+8.687589928 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.595782623 -0500 EST m=+8.687610161 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.595576924 -0500 EST m=+8.687404463 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.596985105 -0500 EST m=+8.688812652 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.597105946 -0500 EST m=+8.688933486 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.597205122 -0500 EST m=+8.689032662 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.597455904 -0500 EST m=+8.689283443 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.598569991 -0500 EST m=+8.690397523 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.598601349 -0500 EST m=+8.690428881 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.59862351 -0500 EST m=+8.690451042 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.599337114 -0500 EST m=+8.691164647 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424599 end 0
    logger.go:54: 2026-02-11 14:37:04.599398807 -0500 EST m=+8.691226340 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.599548086 -0500 EST m=+8.691375619 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424599 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.607146289 -0500 EST m=+8.698973837 level info tenant fake msg queueing wal block for completion block cfea382a-beb8-4169-a45e-dc093a814fc4 size 29257
    logger.go:54: 2026-02-11 14:37:04.62672758 -0500 EST m=+8.718555127 level info tenant fake msg completed block id cfea382a-beb8-4169-a45e-dc093a814fc4
    logger.go:54: 2026-02-11 14:37:04.627160584 -0500 EST m=+8.718988116 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.627181757 -0500 EST m=+8.719009289 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.627299166 -0500 EST m=+8.719126698 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.627174845 -0500 EST m=+8.719002378 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.627351728 -0500 EST m=+8.719179261 level info msg instance removed from the ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.627180918 -0500 EST m=+8.719008450 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.627225143 -0500 EST m=+8.719052674 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.627377394 -0500 EST m=+8.719204926 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.628286084 -0500 EST m=+8.720113620 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.628404882 -0500 EST m=+8.720232416 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.628499063 -0500 EST m=+8.720326597 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.628749755 -0500 EST m=+8.720577287 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.629916354 -0500 EST m=+8.721743886 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.629945667 -0500 EST m=+8.721773199 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.62996991 -0500 EST m=+8.721797441 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.630722959 -0500 EST m=+8.722550491 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424630 end 0
    logger.go:54: 2026-02-11 14:37:04.630791813 -0500 EST m=+8.722619346 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.63094136 -0500 EST m=+8.722768893 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424630 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.638515086 -0500 EST m=+8.730342635 level info tenant fake msg queueing wal block for completion block 0e90a2dc-0256-4713-8c70-473ed0426df0 size 29585
    logger.go:54: 2026-02-11 14:37:04.658265299 -0500 EST m=+8.750092846 level info tenant fake msg completed block id 0e90a2dc-0256-4713-8c70-473ed0426df0
    logger.go:54: 2026-02-11 14:37:04.658705838 -0500 EST m=+8.750533386 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:04.658719779 -0500 EST m=+8.750547315 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.658733972 -0500 EST m=+8.750561504 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.658768822 -0500 EST m=+8.750596361 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:04.658894186 -0500 EST m=+8.750721731 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:04.6587927 -0500 EST m=+8.750620239 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.658869812 -0500 EST m=+8.750697351 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.658986122 -0500 EST m=+8.750813668 level info msg instance removed from the ring ring live-store
--- PASS: TestLiveStoreUsesRecordTimestampForBlockStartAndEnd (0.10s)
=== RUN   TestLiveStoreShutdownWithPendingCompletions
    logger.go:54: 2026-02-11 14:37:04.660162342 -0500 EST m=+8.751989875 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.660218065 -0500 EST m=+8.752045596 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.660303209 -0500 EST m=+8.752130742 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.660535118 -0500 EST m=+8.752362657 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.661939457 -0500 EST m=+8.753767003 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:04.661982823 -0500 EST m=+8.753810362 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.662020659 -0500 EST m=+8.753848198 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.662881604 -0500 EST m=+8.754709149 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424662 end 0
    logger.go:54: 2026-02-11 14:37:04.662973499 -0500 EST m=+8.754801039 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.663259752 -0500 EST m=+8.755087291 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424662 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.668709256 -0500 EST m=+8.760536804 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:04.668794031 -0500 EST m=+8.760621567 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:04.668734585 -0500 EST m=+8.760562116 level error msg metric lag failed: err fetch offsets: context canceled retries 1
    logger.go:54: 2026-02-11 14:37:04.668735336 -0500 EST m=+8.760562868 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:04.678541154 -0500 EST m=+8.770368704 level info tenant fake msg queueing wal block for completion block 7186da96-05dc-44f6-a112-0d99d0330dc4 size 44759
    logger.go:54: 2026-02-11 14:37:04.680232064 -0500 EST m=+8.772059595 level debug msg enqueueing complete op tenant fake block 7186da96-05dc-44f6-a112-0d99d0330dc4 attempts 0
    logger.go:54: 2026-02-11 14:37:04.700553493 -0500 EST m=+8.792381029 level error tenant fake msg failed to create complete block id 7186da96-05dc-44f6-a112-0d99d0330dc4 err context canceled
    logger.go:54: 2026-02-11 14:37:04.70095532 -0500 EST m=+8.792782852 level error msg failed to complete block tenant fake block 7186da96-05dc-44f6-a112-0d99d0330dc4 err context canceled
    logger.go:54: 2026-02-11 14:37:04.701006267 -0500 EST m=+8.792833799 level debug msg retry cancelled due to shutdown tenant fake block 7186da96-05dc-44f6-a112-0d99d0330dc4
--- PASS: TestLiveStoreShutdownWithPendingCompletions (0.04s)
=== RUN   TestLiveStoreQueryMethodsBeforeStarted
=== RUN   TestLiveStoreQueryMethodsBeforeStarted/SearchRecent
=== RUN   TestLiveStoreQueryMethodsBeforeStarted/SearchTags
=== RUN   TestLiveStoreQueryMethodsBeforeStarted/SearchTagsV2
=== RUN   TestLiveStoreQueryMethodsBeforeStarted/SearchTagValues
=== RUN   TestLiveStoreQueryMethodsBeforeStarted/SearchTagValuesV2
=== RUN   TestLiveStoreQueryMethodsBeforeStarted/QueryRange
--- PASS: TestLiveStoreQueryMethodsBeforeStarted (0.00s)
    --- PASS: TestLiveStoreQueryMethodsBeforeStarted/SearchRecent (0.00s)
    --- PASS: TestLiveStoreQueryMethodsBeforeStarted/SearchTags (0.00s)
    --- PASS: TestLiveStoreQueryMethodsBeforeStarted/SearchTagsV2 (0.00s)
    --- PASS: TestLiveStoreQueryMethodsBeforeStarted/SearchTagValues (0.00s)
    --- PASS: TestLiveStoreQueryMethodsBeforeStarted/SearchTagValuesV2 (0.00s)
    --- PASS: TestLiveStoreQueryMethodsBeforeStarted/QueryRange (0.00s)
=== RUN   TestRequeueOnError
    logger.go:54: 2026-02-11 14:37:04.702454356 -0500 EST m=+8.794281889 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:04.702518646 -0500 EST m=+8.794346178 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:04.702579259 -0500 EST m=+8.794406791 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:04.702766106 -0500 EST m=+8.794593639 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:04.703856594 -0500 EST m=+8.795684125 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:04.703885588 -0500 EST m=+8.795713121 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:04.70494124 -0500 EST m=+8.796768779 level debug partition 0 msg initial lag calculated lag 0 committed 1770831424704 end 0
    logger.go:54: 2026-02-11 14:37:04.705046554 -0500 EST m=+8.796874093 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:04.705319234 -0500 EST m=+8.797146773 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831424704 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:04.719836703 -0500 EST m=+8.811664250 level info tenant fake msg queueing wal block for completion block b866617a-6504-4b3a-8bd1-539d881ab948 size 46705
    logger.go:54: 2026-02-11 14:37:04.721602613 -0500 EST m=+8.813430146 level debug msg enqueueing complete op tenant fake block b866617a-6504-4b3a-8bd1-539d881ab948 attempts 0
    logger.go:54: 2026-02-11 14:37:04.724258341 -0500 EST m=+8.816085873 level error tenant fake msg failed to create complete block id b866617a-6504-4b3a-8bd1-539d881ab948 err forced error
    logger.go:54: 2026-02-11 14:37:04.724315563 -0500 EST m=+8.816143094 level error msg failed to complete block tenant fake block b866617a-6504-4b3a-8bd1-539d881ab948 err forced error
    logger.go:54: 2026-02-11 14:37:04.924364328 -0500 EST m=+9.016191861 level debug msg requeueing complete op tenant fake block b866617a-6504-4b3a-8bd1-539d881ab948 attempts 1
    logger.go:54: 2026-02-11 14:37:04.949887095 -0500 EST m=+9.041714632 level info tenant fake msg completed block id b866617a-6504-4b3a-8bd1-539d881ab948
--- PASS: TestRequeueOnError (1.02s)
=== RUN   TestIsLagged
=== RUN   TestIsLagged/config_disabled_-_never_lagged
    logger.go:54: 2026-02-11 14:37:05.722671454 -0500 EST m=+9.814498987 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:05.722734718 -0500 EST m=+9.814562250 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:05.722801767 -0500 EST m=+9.814629300 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:05.723058189 -0500 EST m=+9.814885721 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:05.724271846 -0500 EST m=+9.816099378 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:05.724309925 -0500 EST m=+9.816137458 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:05.724329485 -0500 EST m=+9.816157018 level info msg live-store ready to serve queries
=== RUN   TestIsLagged/config_disabled_-_never_lagged/isLagged
=== RUN   TestIsLagged/config_disabled_-_never_lagged/SearchRecent
=== RUN   TestIsLagged/config_disabled_-_never_lagged/QueryRange
=== RUN   TestIsLagged/lag_unknown_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.725211844 -0500 EST m=+9.817039376 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:05.72527773 -0500 EST m=+9.817105263 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:05.72534123 -0500 EST m=+9.817168762 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:05.725572864 -0500 EST m=+9.817400403 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:05.726842363 -0500 EST m=+9.818669895 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:05.726876658 -0500 EST m=+9.818704189 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:05.726898261 -0500 EST m=+9.818725793 level info msg live-store ready to serve queries
=== RUN   TestIsLagged/lag_unknown_-_should_be_lagged/isLagged
=== NAME  TestIsLagged/lag_unknown_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.72694428 -0500 EST m=+9.818771812 level debug msg High watermark not set yet
=== RUN   TestIsLagged/lag_unknown_-_should_be_lagged/SearchRecent
=== NAME  TestIsLagged/lag_unknown_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.727020208 -0500 EST m=+9.818847739 level debug msg High watermark not set yet
=== RUN   TestIsLagged/lag_unknown_-_should_be_lagged/QueryRange
=== NAME  TestIsLagged/lag_unknown_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.727088651 -0500 EST m=+9.818916184 level debug msg High watermark not set yet
=== RUN   TestIsLagged/no_last_record_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.728149322 -0500 EST m=+9.819976878 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:05.728247991 -0500 EST m=+9.820075544 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:05.728366955 -0500 EST m=+9.820194486 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:05.728586065 -0500 EST m=+9.820413604 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:05.729682964 -0500 EST m=+9.821510496 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:05.729715799 -0500 EST m=+9.821543331 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:05.729740267 -0500 EST m=+9.821567799 level info msg live-store ready to serve queries
=== RUN   TestIsLagged/no_last_record_-_should_be_lagged/isLagged
=== NAME  TestIsLagged/no_last_record_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.729783886 -0500 EST m=+9.821611419 level debug msg No last record yet
=== RUN   TestIsLagged/no_last_record_-_should_be_lagged/SearchRecent
=== NAME  TestIsLagged/no_last_record_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.729865919 -0500 EST m=+9.821693452 level debug msg No last record yet
=== RUN   TestIsLagged/no_last_record_-_should_be_lagged/QueryRange
=== NAME  TestIsLagged/no_last_record_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.729930146 -0500 EST m=+9.821757678 level debug msg No last record yet
=== RUN   TestIsLagged/no_lag_-_recent_request_-_not_lagged
    logger.go:54: 2026-02-11 14:37:05.73056004 -0500 EST m=+9.822387585 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:05.730672479 -0500 EST m=+9.822500025 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:05.730784433 -0500 EST m=+9.822611965 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:05.730997815 -0500 EST m=+9.822825355 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:05.732507619 -0500 EST m=+9.824335158 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:05.732558088 -0500 EST m=+9.824385627 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:05.732599288 -0500 EST m=+9.824426827 level info msg live-store ready to serve queries
=== RUN   TestIsLagged/no_lag_-_recent_request_-_not_lagged/isLagged
=== RUN   TestIsLagged/no_lag_-_recent_request_-_not_lagged/SearchRecent
=== RUN   TestIsLagged/no_lag_-_recent_request_-_not_lagged/QueryRange
=== RUN   TestIsLagged/high_lag_-_recent_request_-_should_be_lagged
    logger.go:54: 2026-02-11 14:37:05.73379656 -0500 EST m=+9.825624106 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:05.733892334 -0500 EST m=+9.825719873 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:05.734008195 -0500 EST m=+9.825835734 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:05.734248475 -0500 EST m=+9.826076008 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:05.735869727 -0500 EST m=+9.827697274 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:05.735925433 -0500 EST m=+9.827752972 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:05.735958693 -0500 EST m=+9.827786232 level info msg live-store ready to serve queries
=== RUN   TestIsLagged/high_lag_-_recent_request_-_should_be_lagged/isLagged
=== RUN   TestIsLagged/high_lag_-_recent_request_-_should_be_lagged/SearchRecent
=== RUN   TestIsLagged/high_lag_-_recent_request_-_should_be_lagged/QueryRange
=== RUN   TestIsLagged/high_lag_-_old_request_-_not_lagged
    logger.go:54: 2026-02-11 14:37:05.736769335 -0500 EST m=+9.828596867 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:05.736832197 -0500 EST m=+9.828659730 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:05.736906903 -0500 EST m=+9.828734434 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:05.737148454 -0500 EST m=+9.828975987 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:05.738442653 -0500 EST m=+9.830270198 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:05.738488886 -0500 EST m=+9.830316425 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:05.738522024 -0500 EST m=+9.830349563 level info msg live-store ready to serve queries
=== RUN   TestIsLagged/high_lag_-_old_request_-_not_lagged/isLagged
=== RUN   TestIsLagged/high_lag_-_old_request_-_not_lagged/SearchRecent
=== RUN   TestIsLagged/high_lag_-_old_request_-_not_lagged/QueryRange
=== RUN   TestIsLagged/high_lag_-_request_at_boundary
    logger.go:54: 2026-02-11 14:37:05.739578917 -0500 EST m=+9.831406448 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:05.73964905 -0500 EST m=+9.831476582 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:05.739714212 -0500 EST m=+9.831541745 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:05.739885173 -0500 EST m=+9.831712705 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:05.741117665 -0500 EST m=+9.832945204 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:05.741171194 -0500 EST m=+9.832998732 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:05.741207918 -0500 EST m=+9.833035457 level info msg live-store ready to serve queries
=== RUN   TestIsLagged/high_lag_-_request_at_boundary/isLagged
=== RUN   TestIsLagged/high_lag_-_request_at_boundary/SearchRecent
=== RUN   TestIsLagged/high_lag_-_request_at_boundary/QueryRange
--- PASS: TestIsLagged (0.02s)
    --- PASS: TestIsLagged/config_disabled_-_never_lagged (0.00s)
        --- PASS: TestIsLagged/config_disabled_-_never_lagged/isLagged (0.00s)
        --- PASS: TestIsLagged/config_disabled_-_never_lagged/SearchRecent (0.00s)
        --- PASS: TestIsLagged/config_disabled_-_never_lagged/QueryRange (0.00s)
    --- PASS: TestIsLagged/lag_unknown_-_should_be_lagged (0.00s)
        --- PASS: TestIsLagged/lag_unknown_-_should_be_lagged/isLagged (0.00s)
        --- PASS: TestIsLagged/lag_unknown_-_should_be_lagged/SearchRecent (0.00s)
        --- PASS: TestIsLagged/lag_unknown_-_should_be_lagged/QueryRange (0.00s)
    --- PASS: TestIsLagged/no_last_record_-_should_be_lagged (0.00s)
        --- PASS: TestIsLagged/no_last_record_-_should_be_lagged/isLagged (0.00s)
        --- PASS: TestIsLagged/no_last_record_-_should_be_lagged/SearchRecent (0.00s)
        --- PASS: TestIsLagged/no_last_record_-_should_be_lagged/QueryRange (0.00s)
    --- PASS: TestIsLagged/no_lag_-_recent_request_-_not_lagged (0.00s)
        --- PASS: TestIsLagged/no_lag_-_recent_request_-_not_lagged/isLagged (0.00s)
        --- PASS: TestIsLagged/no_lag_-_recent_request_-_not_lagged/SearchRecent (0.00s)
        --- PASS: TestIsLagged/no_lag_-_recent_request_-_not_lagged/QueryRange (0.00s)
    --- PASS: TestIsLagged/high_lag_-_recent_request_-_should_be_lagged (0.00s)
        --- PASS: TestIsLagged/high_lag_-_recent_request_-_should_be_lagged/isLagged (0.00s)
        --- PASS: TestIsLagged/high_lag_-_recent_request_-_should_be_lagged/SearchRecent (0.00s)
        --- PASS: TestIsLagged/high_lag_-_recent_request_-_should_be_lagged/QueryRange (0.00s)
    --- PASS: TestIsLagged/high_lag_-_old_request_-_not_lagged (0.00s)
        --- PASS: TestIsLagged/high_lag_-_old_request_-_not_lagged/isLagged (0.00s)
        --- PASS: TestIsLagged/high_lag_-_old_request_-_not_lagged/SearchRecent (0.00s)
        --- PASS: TestIsLagged/high_lag_-_old_request_-_not_lagged/QueryRange (0.00s)
    --- PASS: TestIsLagged/high_lag_-_request_at_boundary (0.00s)
        --- PASS: TestIsLagged/high_lag_-_request_at_boundary/isLagged (0.00s)
        --- PASS: TestIsLagged/high_lag_-_request_at_boundary/SearchRecent (0.00s)
        --- PASS: TestIsLagged/high_lag_-_request_at_boundary/QueryRange (0.00s)
=== RUN   TestMetrics_InitialValues
--- PASS: TestMetrics_InitialValues (0.00s)
=== RUN   TestMetrics_PushBytesTracking
--- PASS: TestMetrics_PushBytesTracking (0.02s)
=== RUN   TestMetrics_CompletionFlow
--- PASS: TestMetrics_CompletionFlow (0.05s)
=== RUN   TestMetrics_EmptyPushBytesRequest
--- PASS: TestMetrics_EmptyPushBytesRequest (0.00s)
=== RUN   TestPartitionReaderCommits
=== RUN   TestPartitionReaderCommits/sync_commits
    logger.go:54: 2026-02-11 14:37:05.825860913 -0500 EST m=+9.917688453 level info msg configured Kafka-wide default number of partitions for auto-created topics (num.partitions) value 1000
    logger.go:54: 2026-02-11 14:37:05.827705551 -0500 EST m=+9.919533090 level debug partition 0 msg initial lag calculated lag 0 committed 1770835025827 end 1
    logger.go:54: 2026-02-11 14:37:05.827830581 -0500 EST m=+9.919658120 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:05.828105096 -0500 EST m=+9.919932635 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input test-topic[0{1770835025827 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:05.837354856 -0500 EST m=+9.929182395 level info component kafka_client msg assigning partitions why remove of map[test-topic:[0]] requested how unassigning any currently assigned matching partition that is in the input input test-topic[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:05.837468181 -0500 EST m=+9.929295712 level info partition 0 msg stopping partition reader
=== RUN   TestPartitionReaderCommits/async_commits
    logger.go:54: 2026-02-11 14:37:05.854161721 -0500 EST m=+9.945989253 level info msg configured Kafka-wide default number of partitions for auto-created topics (num.partitions) value 1000
    logger.go:54: 2026-02-11 14:37:05.85568369 -0500 EST m=+9.947511223 level debug partition 0 msg initial lag calculated lag 0 committed 1770835025855 end 1
    logger.go:54: 2026-02-11 14:37:05.855743359 -0500 EST m=+9.947570898 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:05.856010684 -0500 EST m=+9.947838217 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input test-topic[0{1770835025855 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:10.8562857 -0500 EST m=+14.948113232 level debug partition 0 msg committed kafka offset offset 1 topic test-topic group test-consumer-group
    logger.go:54: 2026-02-11 14:37:10.857424036 -0500 EST m=+14.949251568 level info component kafka_client msg assigning partitions why remove of map[test-topic:[0]] requested how unassigning any currently assigned matching partition that is in the input input test-topic[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:10.857429532 -0500 EST m=+14.949257071 level debug partition 0 msg nothing to commit lastCommittedOffset 1 offset 1
    logger.go:54: 2026-02-11 14:37:10.857605576 -0500 EST m=+14.949433112 level info partition 0 msg stopping partition reader
--- PASS: TestPartitionReaderCommits (5.05s)
    --- PASS: TestPartitionReaderCommits/sync_commits (0.03s)
    --- PASS: TestPartitionReaderCommits/async_commits (5.02s)
=== RUN   TestPartitionReaderLag
    logger.go:54: 2026-02-11 14:37:10.859605081 -0500 EST m=+14.951432620 level info msg configured Kafka-wide default number of partitions for auto-created topics (num.partitions) value 1000
    logger.go:54: 2026-02-11 14:37:10.861325496 -0500 EST m=+14.953153035 level debug partition 0 msg initial lag calculated lag 0 committed 1770835030860 end 0
    logger.go:54: 2026-02-11 14:37:10.861400758 -0500 EST m=+14.953228304 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:10.861790469 -0500 EST m=+14.953618031 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input test-topic[0{1770835030860 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:10.886816894 -0500 EST m=+14.978644433 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.899931922 -0500 EST m=+14.991759461 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.912603085 -0500 EST m=+15.004430617 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.925880671 -0500 EST m=+15.017708209 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.938821371 -0500 EST m=+15.030648903 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.952803616 -0500 EST m=+15.044631155 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.96702632 -0500 EST m=+15.058853860 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.982253088 -0500 EST m=+15.074080627 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:10.995853958 -0500 EST m=+15.087681498 level error partition 0 msg encountered error processing records; skipping err error consuming records
    logger.go:54: 2026-02-11 14:37:11.996291677 -0500 EST m=+16.088119216 level info component kafka_client msg assigning partitions why remove of map[test-topic:[0]] requested how unassigning any currently assigned matching partition that is in the input input test-topic[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:11.996401306 -0500 EST m=+16.088228838 level info partition 0 msg stopping partition reader
--- PASS: TestPartitionReaderLag (1.14s)
=== RUN   TestPhase1_C2_WorkerThreadDeathFix
    phase1_fixes_test.go:12: FAILING TEST - demonstrates C-2 bug: worker thread exits on single error
--- SKIP: TestPhase1_C2_WorkerThreadDeathFix (0.00s)
=== RUN   TestPhase1_C7_DataLossOnContextCancellationFix
    phase1_fixes_test.go:30: FAILING TEST - demonstrates C-7 bug: silent data loss on context cancel
--- SKIP: TestPhase1_C7_DataLossOnContextCancellationFix (0.00s)
=== RUN   TestPhase1_C14_UnhandledInstanceCreationErrorFix
    phase1_fixes_test.go:47: FAILING TEST - demonstrates C-14 bug: records dropped on instance error
--- SKIP: TestPhase1_C14_UnhandledInstanceCreationErrorFix (0.00s)
=== RUN   TestPhase1_C17_WALBlockClearFailureFix
    phase1_fixes_test.go:68: FAILING TEST - demonstrates C-17 bug: orphaned WAL blocks on disk
--- SKIP: TestPhase1_C17_WALBlockClearFailureFix (0.00s)
=== RUN   TestPhase1_C9_MissingContextCheckInConsumeLoopFix
    phase1_fixes_test.go:90: FAILING TEST - demonstrates C-9 bug: consume loop ignores context cancellation
--- SKIP: TestPhase1_C9_MissingContextCheckInConsumeLoopFix (0.00s)
=== RUN   TestPhase1_C16_ContextNotCheckedInBackpressureLoopFix
    phase1_fixes_test.go:104: FAILING TEST - demonstrates C-16 bug: processes batch after context cancelled
--- SKIP: TestPhase1_C16_ContextNotCheckedInBackpressureLoopFix (0.00s)
=== RUN   TestPhase1_IntegrationTest_DataLossPrevention
    phase1_fixes_test.go:124: INTEGRATION TEST - will pass after all Phase 1 fixes complete
--- SKIP: TestPhase1_IntegrationTest_DataLossPrevention (0.00s)
=== RUN   TestPhase1_CircuitBreakerInConsume
    phase1_fixes_test.go:146: FAILING TEST - demonstrates missing circuit breaker
--- SKIP: TestPhase1_CircuitBreakerInConsume (0.00s)
=== RUN   TestPhase1_RaceDetection
    phase1_fixes_test.go:169: Run all tests with: go test -race ./modules/livestore/...
--- PASS: TestPhase1_RaceDetection (0.00s)
=== RUN   TestPhase2_C1_RaceInGetOrCreateInstanceFix
    phase2_fixes_test.go:20: FAILING TEST - demonstrates C-1 race: instance visible before goroutines start
--- SKIP: TestPhase2_C1_RaceInGetOrCreateInstanceFix (0.00s)
=== RUN   TestPhase2_C1_BackgroundGoroutinesStartBeforeMapInsert
    phase2_fixes_test.go:45: FAILING TEST - demonstrates C-1: goroutines not ready
--- SKIP: TestPhase2_C1_BackgroundGoroutinesStartBeforeMapInsert (0.00s)
=== RUN   TestPhase2_C3_DataRaceInSearchTagValuesFix
    phase2_fixes_test.go:63: FAILING TEST - demonstrates C-3 race: non-atomic counter access
--- SKIP: TestPhase2_C3_DataRaceInSearchTagValuesFix (0.00s)
=== RUN   TestPhase2_C11_ContextLifecycleViolationFix
    phase2_fixes_test.go:81: FAILING TEST - demonstrates C-11: independent context tree
--- SKIP: TestPhase2_C11_ContextLifecycleViolationFix (0.00s)
=== RUN   TestPhase2_C13_UnsafeMutexUnlockFix
    phase2_fixes_test.go:106: FAILING TEST - demonstrates C-13 race: mutex unlocked before data consumption
--- SKIP: TestPhase2_C13_UnsafeMutexUnlockFix (0.00s)
=== RUN   TestPhase2_C18_RaceOnLastRecordTimeNanosFix
    phase2_fixes_test.go:124: FAILING TEST - demonstrates C-18 race: initialization race
--- SKIP: TestPhase2_C18_RaceOnLastRecordTimeNanosFix (0.00s)
=== RUN   TestPhase2_IntegrationTest_RaceConditionsFree
    phase2_fixes_test.go:144: INTEGRATION TEST - validates all Phase 2 race fixes
--- SKIP: TestPhase2_IntegrationTest_RaceConditionsFree (0.00s)
=== RUN   TestPhase2_C1_GoroutineStartupTimeout
    phase2_fixes_test.go:171: Test for ready channel timeout in C-1 fix
--- SKIP: TestPhase2_C1_GoroutineStartupTimeout (0.00s)
=== RUN   TestPhase2_StressTest_ConcurrentInstanceCreation
    phase2_fixes_test.go:185: STRESS TEST - validates instance creation under load
--- SKIP: TestPhase2_StressTest_ConcurrentInstanceCreation (0.00s)
=== RUN   TestPhase3_C6_UnboundedGoroutineSpawningFix
    phase3_fixes_test.go:19: FAILING TEST - demonstrates C-6: 1500+ goroutines under load
--- SKIP: TestPhase3_C6_UnboundedGoroutineSpawningFix (0.00s)
=== RUN   TestPhase3_C6_WorkerPoolPattern
    phase3_fixes_test.go:48: Test for worker pool implementation in C-6 fix
--- SKIP: TestPhase3_C6_WorkerPoolPattern (0.00s)
=== RUN   TestPhase3_C12_GoroutineLeakInRetryLogicFix
    phase3_fixes_test.go:68: FAILING TEST - demonstrates C-12: untracked retry goroutines
--- SKIP: TestPhase3_C12_GoroutineLeakInRetryLogicFix (0.00s)
=== RUN   TestPhase3_C12_RetryGoroutineContextAware
    phase3_fixes_test.go:96: Test for context-aware retry in C-12 fix
--- SKIP: TestPhase3_C12_RetryGoroutineContextAware (0.00s)
=== RUN   TestPhase3_C20_UnboundedInstanceAccumulationFix
    phase3_fixes_test.go:117: FAILING TEST - demonstrates C-20: instances never cleaned up
--- SKIP: TestPhase3_C20_UnboundedInstanceAccumulationFix (0.00s)
=== RUN   TestPhase3_C20_IdleInstanceCleanup
    phase3_fixes_test.go:143: Test for idle instance cleanup in C-20 fix
--- SKIP: TestPhase3_C20_IdleInstanceCleanup (0.00s)
=== RUN   TestPhase3_IntegrationTest_ResourceLeaksFree
    phase3_fixes_test.go:167: INTEGRATION TEST - validates all Phase 3 resource fixes
--- SKIP: TestPhase3_IntegrationTest_ResourceLeaksFree (0.00s)
=== RUN   TestPhase3_StressTest_QueryConcurrency
    phase3_fixes_test.go:192: STRESS TEST - query concurrency with worker pool
--- SKIP: TestPhase3_StressTest_QueryConcurrency (0.00s)
=== RUN   TestPhase3_MemoryProfiling
    phase3_fixes_test.go:213: Memory profiling test for Phase 3
--- SKIP: TestPhase3_MemoryProfiling (0.00s)
=== RUN   TestPhase4_C5_LockContentionBlocksWritesFix
    phase4_fixes_test.go:19: FAILING TEST - demonstrates C-5: writes blocked by query lock
--- SKIP: TestPhase4_C5_LockContentionBlocksWritesFix (0.00s)
=== RUN   TestPhase4_C5_SnapshotPattern
    phase4_fixes_test.go:45: Test for snapshot pattern in C-5 fix
--- SKIP: TestPhase4_C5_SnapshotPattern (0.00s)
=== RUN   TestPhase4_H1_N1QueryPatternFix
    phase4_fixes_test.go:70: FAILING TEST - demonstrates H-1: searches all 150 blocks for one trace
--- SKIP: TestPhase4_H1_N1QueryPatternFix (0.00s)
=== RUN   TestPhase4_H1_EarlyTermination
    phase4_fixes_test.go:95: Test for early termination in H-1 fix
--- SKIP: TestPhase4_H1_EarlyTermination (0.00s)
=== RUN   TestPhase4_H3_InefficientAllocationsFix
    phase4_fixes_test.go:114: FAILING TEST - demonstrates H-3: 45+ allocations per record
--- SKIP: TestPhase4_H3_InefficientAllocationsFix (0.00s)
=== RUN   TestPhase4_IntegrationTest_PerformanceCriticalPath
    phase4_fixes_test.go:144: INTEGRATION TEST - validates all Phase 4 performance fixes
--- SKIP: TestPhase4_IntegrationTest_PerformanceCriticalPath (0.00s)
=== RUN   TestPhase4_StressTest_HighThroughputIngestion
    phase4_fixes_test.go:249: STRESS TEST - high throughput ingestion
--- SKIP: TestPhase4_StressTest_HighThroughputIngestion (0.00s)
=== RUN   TestPhase4_RegressionTest_CorrectnessAfterOptimization
    phase4_fixes_test.go:271: Regression test for Phase 4 correctness
--- SKIP: TestPhase4_RegressionTest_CorrectnessAfterOptimization (0.00s)
=== CONT  TestInstanceSearchMetrics
    logger.go:54: 2026-02-11 14:37:12.000033432 -0500 EST m=+16.091860980 level info msg reloading wal blocks
    logger.go:54: 2026-02-11 14:37:12.000162185 -0500 EST m=+16.091989733 level warn msg unowned file entry ignored during wal replay file blocks err <nil>
    logger.go:54: 2026-02-11 14:37:12.000281722 -0500 EST m=+16.092109261 level info ring livestore-partitions msg partition not found in the ring partition 0
    logger.go:54: 2026-02-11 14:37:12.000564256 -0500 EST m=+16.092391788 level info msg instance not found in the ring instance test-1 ring live-store
    logger.go:54: 2026-02-11 14:37:12.002374102 -0500 EST m=+16.094201648 level warn msg live store has been started with all background processes suspended! this is meant for testing only
    logger.go:54: 2026-02-11 14:37:12.002428611 -0500 EST m=+16.094256150 level info msg catch-up waiting disabled (readiness_target_lag=0)
    logger.go:54: 2026-02-11 14:37:12.002468024 -0500 EST m=+16.094295563 level info msg live-store ready to serve queries
    logger.go:54: 2026-02-11 14:37:12.003782757 -0500 EST m=+16.095610296 level debug partition 0 msg initial lag calculated lag 0 committed 1770831432003 end 0
    logger.go:54: 2026-02-11 14:37:12.00386671 -0500 EST m=+16.095694249 level info component kafka_client msg immediate metadata update triggered why from AddConsumePartitions
    logger.go:54: 2026-02-11 14:37:12.004161713 -0500 EST m=+16.095989245 level info component kafka_client msg assigning partitions why new assignments from direct consumer how assigning everything new, keeping current assignment input traces[0{1770831432003 e-1 ce0}]
    logger.go:54: 2026-02-11 14:37:15.977552031 -0500 EST m=+20.069379579 level info tenant fake msg queueing wal block for completion block 04d7b187-2697-44ca-b50a-6602a96afa3d size 14398653
    logger.go:54: 2026-02-11 14:37:17.003917515 -0500 EST m=+21.095745054 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:19.493426032 -0500 EST m=+23.585253578 level info tenant fake msg completed block id 04d7b187-2697-44ca-b50a-6602a96afa3d
    logger.go:54: 2026-02-11 14:37:19.578003365 -0500 EST m=+23.669830911 level info msg ring lifecycler is shutting down ring live-store
    logger.go:54: 2026-02-11 14:37:19.578006335 -0500 EST m=+23.669833882 level info ring livestore-partitions msg partition ring lifecycler is shutting down ring livestore-partitions
    logger.go:54: 2026-02-11 14:37:19.578013076 -0500 EST m=+23.669840615 level debug partition 0 msg no offset found for committing offset
    logger.go:54: 2026-02-11 14:37:19.578201823 -0500 EST m=+23.670029361 level info msg unregistering instance from ring ring live-store
    logger.go:54: 2026-02-11 14:37:19.578035344 -0500 EST m=+23.669862880 level info component kafka_client msg assigning partitions why remove of map[traces:[0]] requested how unassigning any currently assigned matching partition that is in the input input traces[0{0 e0 ce0}]
    logger.go:54: 2026-02-11 14:37:19.578123489 -0500 EST m=+23.669951028 level error msg metric lag failed: err context canceled retries 1
    logger.go:54: 2026-02-11 14:37:19.578425825 -0500 EST m=+23.670253357 level info partition 0 msg stopping partition reader
    logger.go:54: 2026-02-11 14:37:19.578294064 -0500 EST m=+23.670121602 level info msg instance removed from the ring ring live-store
--- PASS: TestInstanceSearchMetrics (7.58s)
FAIL
FAIL	github.com/grafana/tempo/modules/livestore	23.738s
?   	github.com/grafana/tempo/modules/livestore/client	[no test files]
FAIL
