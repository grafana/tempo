---
title: Version 2.9 release notes
menuTitle: V2.9
description: Release notes for Grafana Tempo 2.9
weight: 20
---

# Version 2.9 release notes

<!-- vale Grafana.We = NO -->
<!-- vale Grafana.GoogleWill = NO -->
<!-- vale Grafana.Timeless = NO -->
<!-- vale Grafana.Parentheses = NO -->

The Tempo team is pleased to announce the release of Tempo 2.9.

This release gives you:

- New MCP (Model Context Protocol) server support for LLM integration with tracing data
- Enhanced TraceQL metrics with sampling capabilities for improved performance
- Experimental vParquet5 block format with optimized compression and storage
- Significant operational improvements for multi-tenant environments
- Enhanced metrics generator capabilities with service graph improvements
- Numerous TraceQL performance and correctness improvements

These release notes highlight the most important features and bug fixes. For a complete list, refer to the [Tempo CHANGELOG](https://github.com/grafana/tempo/releases).

## Features and enhancements

The most important features and enhancements in Tempo 2.9 are highlighted below.

### MCP server support

Tempo 2.9 introduces support for the Model Context Protocol (MCP), enabling Large Language Models (LLMs) and other AI agents to access tracing data directly.
This experimental feature adds an MCP server shim in the query frontend, allowing seamless integration with AI systems for trace analysis and debugging. ([PR 5212](https://github.com/grafana/tempo/pull/5212))

{{< admonition type="warning" >}}
Be aware that using this feature will likely cause tracing data to be passed to an LLM or LLM provider. Consider the content of your tracing data and organizational policies when enabling the MCP server.
{{< /admonition >}}

The feature is disabled by default and can be enabled per tenant for specific use cases.

For configuration details and examples, refer to [MCP server](/docs/tempo/<TEMPO_VERSION>/api_docs/mcp-server/).

### TraceQL metrics sampling

A new query hint system allows for faster TraceQL metrics queries through adaptive sampling. The `with(sample=true)` hint enables approximate results using probabilistic sampling at the storage layer, significantly improving query performance for large datasets.
Additional hints include `span_sample=0.xx` and `trace_sample=0.xx` for fixed percentage sampling, providing flexibility in balancing performance versus accuracy. ([PR 5469](https://github.com/grafana/tempo/pull/5469))

Example:

```traceql
{} | rate() with(sample=true)
{} | rate() with(span_sample=0.1)
```

### New vParquet5 block format previews (experimental)

{{< docs/experimental product="vParquet5" >}}

Tempo 2.9 introduces a new experimental vParquet5 block format, designed to improve query performance and reduce storage requirements.

vParquet5 has two previews:

- `vParquet5-preview1`: low-resolution timestamp columns
- `vParquet5-preview2`: Dedicated integer columns

Breaking changes are expected before the final release.

`vParquet5-preview1` introduces low-resolution timestamp columns rounded to common time intervals.
This optimization significantly improves compression ratios and reduces I/O for metrics queries, especially when operating at scale. ([PR 5495](https://github.com/grafana/tempo/pull/5495))

Building on `vParquet5-preview1`, `vParquet5-preview2` adds dedicated columns for integer values, further optimizing storage and query performance by avoiding the overhead of storing integers as strings.
This preview is particularly beneficial for high-cardinality integer attributes. ([PR 5639](https://github.com/grafana/tempo/pull/5639))

To enable either preview, you need to set the `version` parameter in the storage configuration block, similar to how other Parquet formats are configured.

Example:

```yaml
storage:
  trace:
    block:
      version: vParquet5-preview1
```

For more information, refer to [Parquet](/docs/tempo/<TEMPO_VERSION>/configuration/parquet/).

### Operational improvements

These improvements help operators running multi-tenant Tempo deployments improve trace quality and operational visibility.

#### SLO Metrics Improvements

Cached querier responses are now excluded from SLO metrics such as inspected bytes, providing more accurate measurements of actual storage and network I/O. This change ensures that performance metrics reflect real resource consumption rather than cached data access. ([PR 5185](https://github.com/grafana/tempo/pull/5185))

#### Enhanced Monitoring and Observability

Several new metrics and histograms have been added to improve operational visibility:

- Added counter `query_frontend_bytes_inspected_total` to track total bytes read from disk and object storage ([PR 5310](https://github.com/grafana/tempo/pull/5310))
- Added histograms `spans_distance_in_future_seconds` / `spans_distance_in_past_seconds` that count spans with timestamps outside expected ranges. While spans in the future are accepted, they are invalid and may not be found using the Search API ([PR 4936](https://github.com/grafana/tempo/pull/4936))
- Added support for scope in cost-attribution usage tracker, allowing more precise tracking with `resource.` or `span.` prefixed attributes ([PR 5646](https://github.com/grafana/tempo/pull/5646))

#### Improved Logging and Tracing

Enhanced logging and tracing in the write path now includes tenant information, making it easier to identify and troubleshoot tenant-specific issues. The `distributor.ConsumeTraces` span status is now properly set to error when trace consumption fails. ([PR 5436](https://github.com/grafana/tempo/pull/5436))

#### Ingress Bytes Monitoring

A new metric `tempo_distributor_ingress_bytes_total` measures bytes received before limits are applied, providing better visibility into incoming data volumes and helping with capacity planning. ([PR 5601](https://github.com/grafana/tempo/pull/5601))

### Metrics Generator improvements

#### Service Graph Enhancements

The definition of `tempo_metrics_generator_processor_service_graphs_expired_edges` has been adjusted to exclude edges that are properly counted in the service graph. This provides more accurate metrics for monitoring service graph health and completeness. ([PR 5319](https://github.com/grafana/tempo/pull/5319))

#### Span metrics processor improvements

Invalid Prometheus label names are now automatically dropped in the span metrics processor, preventing metric ingestion errors and ensuring compatibility with Prometheus naming conventions. ([PR 5122](https://github.com/grafana/tempo/pull/5122))

#### OpenTelemetry standard support

Added support for the new `db.namespace` attribute for service-graph database nodes, aligning with newer OpenTelemetry semantic conventions. This provides better categorization and visualization of database interactions in service graphs. ([PR 5602](https://github.com/grafana/tempo/pull/5602))

#### Peer attributes for service graph

Service graph client virtual nodes now use peer attributes to determine client service names, providing more accurate representation of service-to-service communications in distributed systems. ([PR 5381](https://github.com/grafana/tempo/pull/5381))

### TraceQL correctness and performance improvements

TraceQL metrics have received several important updates that improve correctness and performance. Refer to [Upgrade considerations](#upgrade-considerations) for breaking changes that may affect your deployment.

#### Performance improvements

Multiple optimizations have been implemented to improve TraceQL query performance:

- Performance increase for basic TraceQL metrics queries through reduced overhead in batch processing ([PR 5247](https://github.com/grafana/tempo/pull/5247))
- General TraceQL search and metrics performance improvements ([PR 5280](https://github.com/grafana/tempo/pull/5280))
- TraceQL performance improvements for complex queries ([PR 5218](https://github.com/grafana/tempo/pull/5218))
- `compare()` function performance optimization ([PR 5419](https://github.com/grafana/tempo/pull/5419))
- TraceQL attribute struct alignment for better memory performance ([PR 5240](https://github.com/grafana/tempo/pull/5240))

#### Function improvements

- Improved exemplar selection in `quantile_over_time()` function provides better representative samples ([PR 5278](https://github.com/grafana/tempo/pull/5278))

#### Bug fixes

- Fixed issue preventing very small time steps in metrics queries ([PR 5441](https://github.com/grafana/tempo/pull/5441))
- Fixed incorrect TraceQL string comparison for strings starting with numbers ([PR 5658](https://github.com/grafana/tempo/pull/5658))
- Fixed incorrect results in TraceQL `compare()` function for spans with array attributes ([PR 5519](https://github.com/grafana/tempo/pull/5519))
- Fixed structural operator behavior with empty left-hand spansets ([PR 5578](https://github.com/grafana/tempo/pull/5578))

## Upgrade considerations

When [upgrading](/docs/tempo/<TEMPO_VERSION>/set-up-for-tracing/setup-tempo/upgrade/) to Tempo 2.9, be aware of these considerations and breaking changes.

### TraceQL metrics breaking changes

Tempo 2.9 includes two breaking changes for TraceQL metrics that improve correctness and user experience but may require updates to existing deployments.

#### Bucket calculation changes

TraceQL metrics buckets are now calculated based on data in the past instead of the future, improving user experience and aligning behavior with Prometheus. This resolves issues with empty last buckets that were previously encountered. ([PR 5366](https://github.com/grafana/tempo/pull/5366))

This change may cause differences in existing dashboards and alerts that rely on TraceQL metrics bucket calculations. Review your monitoring and alerting configurations after upgrading.

#### Series label handling improvements

Fixed incorrect TraceQL metrics results when series labels include both strings and integers with the same textual representation (such as `"500"` vs `500`). The `prom_labels` field has been removed from TraceQL metrics responses as it was the source of these errors. ([PR 5659](https://github.com/grafana/tempo/pull/5659))

There may be brief interruptions to TraceQL metrics queries during rollout while components run different versions. Plan for a coordinated rollout to minimize impact.

### Go version upgrade

Tempo 2.9 upgrades to Go 1.25.0, which may affect custom builds or deployments with specific Go version requirements. ([PR 5548](https://github.com/grafana/tempo/pull/5548))

If you're building Tempo from source or using custom Docker images, ensure your build environment supports Go 1.25.0.

### vParquet5 preview formats

The new vParquet5-preview1 and vParquet5-preview2 block formats are experimental and not recommended for production use. Breaking changes are expected before the final release. These formats are provided for testing and feedback purposes only.

## Bug fixes

For a complete list, refer to the [Tempo CHANGELOG](https://github.com/grafana/tempo/releases).

<!-- vale Grafana.We = YES -->
<!-- vale Grafana.GoogleWill = YES -->
<!-- vale Grafana.Timeless = YES -->
<!-- vale Grafana.Parentheses = YES -->
