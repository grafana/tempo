---
title: V1.5
weight: 70
---

# Version 1.5 release notes

The Tempo team is pleased to announce the release of Tempo 1.5.

With this release, Tempo adds Parquet block support (experimental), anonymous usage reporting to help the Tempo team and Grafana understand how Tempo is used, and enhancements to the metrics-generator. 

In addition to the items detailed below, the [application performance management (APM) dashboard](https://grafana.com/docs/tempo/latest/metrics-generator/app-performance-mgmt/) visualizes span metrics (traces data for rates, error rates, and durations (RED)) and service graphs in Grafana 9.1.

## Features and enhancements

Version 1.5 contains the following features and enhancements. 

### Metrics-generator enhancements

The [metrics-generator]({{< relref "../metrics-generator/" >}}) now includes databases and requests across messaging systems in service graph metrics. 
The OpenTelemetry semantic conventions are used to detect when a span is involved in one of these systems. [PR 1576](https://github.com/grafana/tempo/pull/1576)

### Apache Parquet block format support

Tempo now has a columnar block format based on Apache Parquet.
A columnar block format has many advantages within Tempo such as enabling faster search but also downstream by enabling a large ecosystem of tools access to the underlying trace data.

Parquet fits all of the requirements:

* Roundtrippable - Support for hierarchical data means regenerating OTLP is straightformat

* More efficient - only read the columns needed for the search

* Faster - only read the columns needed

* Similar or better block size - About a ~5% smaller block size for parquet

* Object storage - Parquet is a file-based approach which translates well to Tempo's block-based design

* Shardable - Parquet naturally includes sub-block structures such as row groups and column chunks which can be processed independently.

This feature is experimental.

For more information, refer to the [Parquet design document](https://github.com/mdisibio/tempo/blob/design-proposal-parquet/docs/design-proposals/2022-04%20Parquet.md) and [Issue 1480](https://github.com/grafana/tempo/issues/1480).

### Usage reporting
  
By default, Tempo will report anonymous usage data about the shape of a deployment to Grafana Labs. This data is used to determine how common the deployment of certain features are, if a feature flag has been enabled, replication factor or compression levels, etc.

Usage reporting helps provide anonymous information on how people use Tempo and what the Tempo team should focus on for features and documentation. No private information is collected, and all reports are completely anonymous.

Reporting is controlled by the `usage_report` configuration option and can be disabled. For instructions, refer to [the Configuration documentation](https://grafana.com/docs/tempo/latest/configuration/#usage-report). [PR 1465](https://github.com/grafana/tempo/pull/1481)

## Upgrade considerations

When upgrading to Tempo v1.5, be aware of these breaking changes:

- [PR 1478](https://github.com/grafana/tempo/pull/1478) To build advanced visualization features into Grafana, we have decided to change our spanmetric names to match OpenTelemetry (OTel) conventions. Any functionality added to Grafana will work whether you use Tempo, Grafana Agent, or the OTel Collector to generate metrics.
   The old histogram metric name in Tempo 1.4.x:
   ```
   traces_spanmetrics_duration_seconds_{sum,count,bucket}
   ```
   New metric name:
   ```
   traces_spanmetrics_latency_{sum,count,bucket}
   ```
   Additionally, the default label `span_status` is renamed to `status_code`.

- [PR 1556](https://github.com/grafana/tempo/pull/1556) Jsonnet users will need to specify ephemeral storage requests and limits for the metrics generator.
   ```
    _config+:: {
      metrics_generator+: {
        ephemeral_storage_request_size: '10Gi',
        ephemeral_storage_limit_size: '11Gi',
      },
    }
   ```

- [PR 1465](https://github.com/grafana/tempo/pull/1481) Anonymous usage reporting has been added. Distributors and metrics generators will now require permissions to object storage equivalent to compactors and ingesters. This feature is enabled by default but can be disabled easily.

- [PR 1558](https://github.com/grafana/tempo/pull/1558) Deprecated metrics `tempodb_(gcs|s3|azure)_request_duration_seconds` have been removed in favor of `tempodb_backend_request_duration_seconds`. These metrics have been deprecated since v1.1.

## Enhancements

- [PR 1421](https://github.com/grafana/tempo/pull/1421) Added the ability to have a per tenant max search duration.

- [PR 1471](https://github.com/grafana/tempo/pull/1471) metrics-generator: expose `max_active_series` as a metric.

- [PR 1457](https://github.com/grafana/tempo/pull/1457) Azure Backend: Added support for authentication with Managed Identities.  

- [PR 1459](https://github.com/grafana/tempo/pull/1459) Added a metric to track feature enablement

- [PR 1470](https://github.com/grafana/tempo/pull/1470) Added S3 config option `insecure_skip_verify`

- [PR 1518](https://github.com/grafana/tempo/pull/1518) Added polling option to reduce issues in Azure `blocklist_poll_jitter_ms`.

- [PR 1484](https://github.com/grafana/tempo/pull/1484) Add a config to query single ingester instance based on trace id hash for Trace By ID API.

- [PR 1519](https://github.com/grafana/tempo/pull/1519) Added blocklist metrics for total backend objects and total backend bytes.

- [PR 1558](https://github.com/grafana/tempo/pull/1558) Added `tempo_querier_external_endpoint_hedged_roundtrips_total` to count the total hedged requests.

- [PR 1442](https://github.com/grafana/tempo/pull/1442) Added tags option for S3 backends. This allows new objects to be written with the configured tags.

- [PR 1434](https://github.com/grafana/tempo/pull/1434) metrics-generator: support per-tenant processor configuration.

- [PR 1456](https://github.com/grafana/tempo/pull/1456) Included the rollout dashboard.

- [PR 1463](https://github.com/grafana/tempo/pull/1463) Added SentinelPassword configuration for Redis.
 
- [PR 1631](https://github.com/grafana/tempo/pull/1631) Added support for time picker in the Jaeger query plugin.

## Changes

- [PR 1439](https://github.com/grafana/tempo/pull/1439) metrics-generator: Added the metric label `instance` to `__metrics_gen_instance` to reduce collisions with custom dimensions.

- [PR 1447](https://github.com/grafana/tempo/pull/1447) `max_bytes_per_tag_values_query` is not enforced when set to 0.

- [PR 1474](https://github.com/grafana/tempo/pull/1474) Added new querier service in deployment Jsonnet to serve `/status` endpoint.

- [PR 1483](https://github.com/grafana/tempo/pull/1483) Swapped out Google Cloud Functions serverless docs and build for Google Cloud Run.

- [PR 1504](https://github.com/grafana/tempo/pull/1504) Updated to Go 1.18.

- [PR 1517](https://github.com/grafana/tempo/pull/1517) Changed tag/value lookups to return partial results when reaching response size limit instead of failing.

- [PR 1547](https://github.com/grafana/tempo/issues/1547) Changed search to be case-sensitive.

- [PR 1566](https://github.com/grafana/tempo/pull/1566) Relaxed Hedged request defaults for external endpoints.
   ```
   querier:
       search:
         external_hedge_requests_at: 4s    -> 8s
         external_hedge_requests_up_to: 3  -> 2
   ```

- [PR 1593](https://github.com/grafana/tempo/pull/1593) Added two additional latency buckets to the default settings for generated spanmetrics. This change will increase cardinality when using the defaults.

- [PR 1465](https://github.com/grafana/tempo/pull/1465) Marked `log_received_traces` as deprecated. The new flag is `log_received_spans`. Extended distributor spans logger with optional features to include span attributes and a filter by error status.

## Bug fixes

### 1.5.0 bug fixes

Version 1.5.0 includes the following fixes: 

- [PR 1441](https://github.com/grafana/tempo/pull/1441) Fixed nil pointer panic when the trace by id path errors.

- [PR 1472](https://github.com/grafana/tempo/pull/1472) Updated Tempo microservices Helm values example which missed the 'enabled' key for thriftHttp.

- [PR 1468](https://github.com/grafana/tempo/pull/1468) Fix race condition in forwarder overrides loop.

- [PR 1538](https://github.com/grafana/tempo/pull/1538) Fixed v2 backend check on span name to be substring.

- [PR 1548](https://github.com/grafana/tempo/pull/1548) Fixed wal check on span name to be substring.

- [Issue 1258](https://github.com/grafana/tempo/issues/1258) Prevented the ingester panic "cannot grow buffer".

- [PR 1554](https://github.com/grafana/tempo/pull/1554) metrics-generator: do not remove `x-scope-orgid header` in single tenant modus.

- [PR 1589](https://github.com/grafana/tempo/pull/1589) Fixed an issue where backend does not support `root.name` and `root.service.name`.

- [Issue 1603](https://github.com/grafana/tempo/issues/1603) Fixed the ingester to continue starting up after block replay error.